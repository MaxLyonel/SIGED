{% extends 'layoutHerramientaAlternativa.html.twig' %}

{% block contentoption %}
    <div class="header-content">
        <h2><i class="fa fa-users"></i> Datos del Docente <span> Datos personales, cargo, financiamiento, idiomas.</span></h2>
        <div class="breadcrumb-wrapper hidden-xs">
            <span class="label">Usted esta aqui:</span>
            <ol class="breadcrumb">
                    <li>
                        <i class="glyphicon glyphicon-leaf"></i>
                            <a href="{{path('principal_web')}}">Bienvenida</a>
                        <i class="fa fa-angle-right"></i>
                    </li>                    
                    <li>
                        <i class="fa fa-th-large"></i>
                            <a href="{{path('herramienta_ceducativa_menu_principal')}}">Menu Principal</a>
                        <i class="fa fa-angle-right"></i>
                    </li>
                    <li>
                        <i class="fa fa-users"></i>
                            <a href="{{path('herramientalt_info_maestro_index')}}">Docentes</a>
                        <i class="fa fa-angle-right"></i>
                    <li>    
                    <li>
                        <i class="fa fa-users"></i>
                            Nuevo docente
                        <i class="fa fa-angle-right"></i>
                    </li>                
            </ol>
        </div><!-- /.breadcrumb-wrapper -->
    </div>

    <div class="body-content animated fadeIn">

        <div class="row">
            <div class="col-lg-12">
                <div class="panel rounded shadow panel-danger">
                    <div class="panel-heading">
                        <div class="pull-left">
                            <h3 class="panel-title">Maestro Nuevo</h3>
                        </div>
                        <div class="pull-right">
                        </div>
                        <div class="clearfix"></div>
                    </div><!-- /.panel-heading -->
                    <div class="panel-body">
                        <div class="panel-body panel-primary">
                            {{form_start(form, { 'attr': {'data-toggle': 'validator','role': 'form', 'onsubmit':  'return (validaIdioma() && validaLista()&& validaSeleccion())'} } )}}
                            <div class="panel-body">
                                <div class="row">
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="carnet">Carnet</label>
                                        <input value="{{ persona.carnet }}" id="carnet" class="form-control" readonly="readonly" type="text">
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="complemento">Complemento</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">-</div>
                                            <input value="{{ persona.complemento }}" id="complemento" class="form-control" readonly="readonly" type="text">
                                        </div>
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="paterno">Apellido Paterno</label>
                                        <input value="{{ persona.paterno }}" id="paterno" class="form-control" readonly="readonly" type="text">
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="materno">Apellido Materno</label>
                                        <input value="{{ persona.materno }}" id="materno" class="form-control" readonly="readonly" type="text">
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="nombre">Nombre(s)</label>
                                        <input value="{{ persona.nombre }}" id="nombre" class="form-control" readonly="readonly" type="text">
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        {{ form_label(form.genero) }}
                                        {{ form_widget(form.genero) }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="fechanac">Fecha de Nacimiento</label>
                                        <input value="{{ persona.fechaNacimiento|date('d-m-Y') }}" id="fechanac" class="form-control" readonly="readonly" type="text">
                                    </div>
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.direccion) }}
                                        {{ form_widget(form.direccion) }}
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        {{ form_label(form.celular) }}
                                        {{ form_widget(form.celular) }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-lg-3 col-md-6">
                                        {{ form_label(form.correo) }}
                                        {{ form_widget(form.correo) }}
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        <label class="control-label" for="rda">RDA</label>
                                        <input value="{{ persona.rda }}" id="rda" class="form-control" readonly="readonly" type="text">
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        {{ form_label(form.item)}}
                                        {{form_widget(form.item) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-3 col-md-6">
                                        {{ form_label(form.normalista)}}
                                        {{form_widget(form.normalista) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group">
                                        <div> <label class="control-label" for="correo">Tipo de Maestro</label></div>
                                        <div class="col-md-6">{{ form_widget(form.educacionDiversaTipo) }}</div>
                                        <div class="col-md-10 form-group" id="answerID"></div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.funcion)}}
                                        {{form_widget(form.funcion) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.financiamiento)}}
                                        {{form_widget(form.financiamiento) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.formacion)}}
                                        {{form_widget(form.formacion) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.formacionDescripcion)}}
                                        {{form_widget(form.formacionDescripcion) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-lg-12">
                                        <fieldset>
                                            <legend>Idioma(s) que conoce la maestra o el maestro <span class="text-danger text-sm">(* Debe registrar al menos un idioma)</span></legend>
                                            <div id="no-more-tables">
                                                <a onclick="agregarHijo()" class="btn-link"><i class="fa fa-plus-square"></i> Agregar Idioma</a>
                                                <table class="table table-striped table-primary">
                                                    <thead>
                                                        <tr>
                                                            <th class="col-lg-4">Idioma</th>
                                                            <th class="col-lg-2">Lee</th>
                                                            <th class="col-lg-2">Habla</th>
                                                            <th class="col-lg-2">Escribe</th>
                                                            <th class="col-lg-2">Eliminar</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="idiomas">

                                                    </tbody>
                                                </table>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    {% if app.session.get('sysname') == 'PERMANENTE' %}
                                        {% set display = 'none' %}
                                    {% else %}
                                        {% set display = 'block' %}
                                    {% endif %}
                                    <div class="form-group col-lg-6 col-md-12" style=" display: {{display}}">
                                        {{ form_label(form.idiomaOriginario)}} 
                                        {{form_widget(form.idiomaOriginario) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                    <div class="form-group col-lg-6 col-md-12">
                                        {{ form_label(form.leeEscribeBraile)}}
                                        {{form_widget(form.leeEscribeBraile) }}
                                        <div class="help-block with-errors"></div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-lg-12 text-center">
                                        {{ form_widget(form.guardar ) }}
                                        <a href="{{ path('herramientalt_info_maestro_index') }}" class="btn btn-default">Cancelar</a>
                                    </div>
                                </div>
                            </div>
                            {{form_end(form)}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> 

{% endblock %}
{% block javascripts %}
    {{parent()}}
    <script>
        var cantidad = 0;
        var cont = 0;
        var conta = 0;
        var contb = 0;
        var contc = 0;

        function agregarHijo()
        {
            cont++;
            if (cont < 5) {
                cantidad++;
                var idioma = 'idioma' + cantidad;
                var lee = 'lee' + cantidad;
                var habla = 'habla' + cantidad;
                var escribe = 'escribe' + cantidad;
                $('#idiomas').append("<tr id='" + cantidad + "' class='info'>\n\
                                        <td data-title='Idioma' class='form-group'><select name='" + idioma + "' id='" + idioma + "' class='form-control' required></select></td>\n\
                                        <td data-title='Lee' class='form-group'><select name='" + lee + "' id='" + lee + "' class='form-control' required></select></td>\n\
                                        <td data-title='Habla' class='form-group'><select name='" + habla + "' id='" + habla + "' class='form-control' required></select></td>\n\
                                        <td data-title='Escribe' class='form-group'><select name='" + escribe + "' id='" + escribe + "' class='form-control' required></select></td>\n\
                                        <td><button type='button' onclick='eliminaridioma(" + cantidad + " )' class='btn-link'><i class='fa fa-trash-o text-danger'> Eliminar</button></td>\n\
                                    </tr>");

                $.ajax({
                    type: 'get',
                    url: Routing.generate('herramientalt_listaridiomasleehablaescribe'),
                    beforeSend: function () {
                        $("#" + idioma).empty();
                    },
                    success: function (data) {
                        $("#" + idioma).empty();
                        $("#" + idioma).append('<option value="">Seleccionar...</option>');
                        $.each(data.idiomas, function (i, value) {
                            $("#" + idioma).append('<option value="' + i + '">' + value + '</option>');
                        });
                        // select lee
                        $("#" + lee).append('<option value="">Seleccionar...</option>');
                        $.each(data.conoce, function (i, value) {
                            $("#" + lee).append('<option value="' + i + '">' + value + '</option>');
                        });
                        // select habla
                        $("#" + habla).append('<option value="">Seleccionar...</option>');
                        $.each(data.conoce, function (i, value) {
                            $("#" + habla).append('<option value="' + i + '">' + value + '</option>');
                        });
                        // select escribe
                        $("#" + escribe).append('<option value="">Seleccionar...</option>');
                        $.each(data.conoce, function (i, value) {
                            $("#" + escribe).append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                });
            } else {
                cont--;
            }

        }

        function reloadmyform(){
            /*
             $('#answerID').change(function () {
             listarmenu($('#form_educacionDiversa').val());
             });*/
            $("#answerID").trigger(onchange(listarmenu($('#form_educacionDiversaTipo').val())));
        }




        function eliminaridioma(i) {
            cont--;
            $("#" + i).remove();
        }

        function validaIdioma() {
            if (cont == 0) {
                alert('Debe registrar al menos un idioma que conoce el Maestro');
                return false;
            }
            return true;
        }
        function validaLista(){
            if(conta == 0 || conta == ""){
                alert('Debe seleccionar el tipo de Maestro');
                return false;
            }
            return true;
        }

        function validaSeleccion(){
            if(conta ==2)
            {
                if((contb == 0 || contb == "")){
                    alert('Debe seleccionar la Unidad Militar a la que pertenece');
                    return false;
                }

            } else if(conta ==3)
            {
                if((contc == 0 || contc == "")){
                    alert('Debe seleccionar el Penal al que pertenece');
                    return false;
                }

            }
            return true;
        }




        function listarmenu(idM){


            var pertUM = $('#form_pertUM').val();
            var pertP= $('#form_pertP').val();
            var umt = $('#form_umt').val();
            var pt= $('#form_pt').val();

            if(idM ==null || idM=="")
            {
                idM ='0';
            }
            conta=idM;
            contb=umt;
            contc=pt;

            // alert(cont+' Debe seleccionar el tipo de Maestro');
            $.ajax({
                type: 'get',
                url: Routing.generate('herramienta_info_maestro_mlistarmenu', {'idM': idM, 'pertUM': pertUM, 'pertP': pertP,'umt':umt,'pt':pt} ),
                beforeSend: function () {
                    $('#answerID').empty();
                    $("#answerID").append('<div class="text-center"><img src="{{asset('img/loading.gif')}} /></div>');
                },
                success: function (data) {
                    $('#answerID').empty();
                    $('#answerID').append(data);

                }
            });
        }

        function tipomili(idUM){


            var pertUM = $('#form_pertUM').val();
            if(idUM ==null || idUM=="")
            {
                idUM ='0';
            }

            contb=idUM;

            $.ajax({
                type: 'get',
                url: Routing.generate('sie_alt_bjp_rue_tipomili', {'idUM': idUM,'pertUM': pertUM} ),
                beforeSend: function (data) {
                    $('#form_seccioniiUnidadMilitarTipo').empty();
                    $('#form_seccioniiUnidadMilitarTipo').append('<div class="text-center"><img src="{{asset('img/loading.gif')}} /></div>');
                },
                success: function (data) {
                    $('#form_seccioniiUnidadMilitarTipo').empty();
                    /*$('#form_seccioniiUnidadMilitar').append(('<option value="">Seleccionar...</option>');*/
                    $.each(data.listarunidadmilitar, function (i, value) {
                        $('#form_seccioniiUnidadMilitarTipo').append('<option value="' + i + '">' + value + '</option>');
                    });

                }
            });
        }


        function tipopenal(idP){

            var pertP= $('#form_pertP').val();

            if(idP ==null || idP=="")
            {
                idP ='0';
            }

            contc=idP;

            $.ajax({
                type: 'get',
                url: Routing.generate('sie_alt_bjp_rue_tipopenal', {'idP': idP, 'pertP': pertP} ),
                beforeSend: function (data) {
                    $('#form_seccioniiRecintoPenitenciarioTipo').empty();
                    $('#form_seccioniiRecintoPenitenciarioTipo').append('<div class="text-center"><img src="{{asset('img/loading.gif')}} /></div>');
                },
                success: function (data) {
                    $('#form_seccioniiRecintoPenitenciarioTipo').empty();
                    /*$('#form_seccioniiPenal').append(('<option value="">Seleccionar...</option>');*/
                    $.each(data.listarpenal, function (i,value) {
                        $('#form_seccioniiRecintoPenitenciarioTipo').append('<option value="' + i + '">' + value + '</option>');
                    });

                }
            });
        }





    </script>
{% endblock %}
