{% extends 'layoutHerramientaAlternativa.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
          integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
          crossorigin=""/>
{% endblock %}
{% block contentoption %}
    <!-- Start page header -->
    <div class="header-content">
        {% if tramite %}
            <h2><i class="fa fa-list-alt"></i> TRAMITE RUE Nro. {{ tramite.id }}:
                <span>{{ tramite.flujoTipo.flujo }}</span></h2>
        {% else %}
            <h2><i class="fa fa-list-alt"></i> TRAMITE RUE: <span>{{ tarea.flujoTipo.flujo }}</span></h2>
        {% endif %}
        <div class="breadcrumb-wrapper hidden-xs">
            <span class="label">Usted esta aquí:</span>
            <ol class="breadcrumb">
                <li>
                    <i class="fa fa-home"></i>
                    <a href="{{ path('wf_tramite_index') }}">Trámite</a>
                    <i class="fa fa-angle-right"></i>
                </li>

            </ol>
        </div><!-- /.breadcrumb-wrapper -->
    </div><!-- /.header-content -->
    <!--/ End page header -->
    <div class="body-content animated fadeIn">
        <div class="row">
            <div class="col-12">
                <div class="panel">
                    <div class="row">
                        <div class="col-md-12">
                            {% if app.session.flashBag.has('exito') %}
                                <div class="alert alert-success">
                                    {% for msg in app.session.flashBag.get('exito') %}
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span></button>
                                        {{ msg }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% if app.session.flashBag.has('error') %}
                                <div class="alert alert-danger">
                                    {% for msg in app.session.flashBag.get('error') %}
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span></button>
                                        {{ msg }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="pull-left">
                                        <h3 class="panel-title">{{ tarea.proceso.procesoTipo }}</h3>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- /.panel-heading -->
                                <div class="panel-body">
                                    {% if tramite %}
                                        <div class="panel-group">
                                            <div class="panel">
                                                <div class="panel-heading">
                                                    <div class="pull-left">
                                                        <a data-toggle="collapse" href="#collapse1"><h4
                                                                    class="panel-title text-lilac"><i
                                                                        class="fa fa-eye"></i>Ver formularios anteriores
                                                            </h4></a>
                                                    </div>
                                                    <div class="clearfix"></div>
                                                </div>
                                                <div id="collapse1" class="panel-collapse collapse">
                                                    <div class="panel-body">
                                                        {% include 'SieProcesosBundle:TramiteCea:historico.html.twig' with {'datos': datos} %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div><!-- /.panel-body -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="pull-left">
                                        <h3 class="panel-title">1. DATOS GENERALES</h3>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- /.panel-heading -->
                                <div class="panel-body">
                                    <div class="form-body">
                                        <div class="row">
                                            <div class="form-group col-md-6">
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>CÓDIGO SIE:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.id }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>CÓDIGO DE EDIFICIO EDUCATIVO:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.leJuridicciongeografica.id }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>DEPENDENCIA:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.dependenciaTipo.dependencia|upper }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>DISTRITO EDUCATIVO:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.leJuridicciongeografica.distritoTipo.distrito }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>FECHA DE FUNDACIÓN:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.fechaFundacion ? institucioneducativa.fechaFundacion|date('d-m-Y'):'' }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6"><strong>NIVELES DE ORGANIZACIÓN
                                                            CURRICULAR:</strong>
                                                        <ul>
                                                            {% set nivel = [] %}
                                                            {% for n in ieNivel %}
                                                                <li type=square>{{ n.nivelTipo.nivel }}</li>
                                                                {% set nivel = nivel|merge([n.nivelTipo.id]) %}
                                                            {% endfor %}
                                                            <input type='hidden' id='nivel'
                                                                   value='{{ nivel|json_encode }}'><input type='hidden'
                                                                                                          id='is_ejpa'
                                                                                                          value='{{ isEjpa }}'>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>CENTRO DE EDUCACIÓN ALTERNATIVA:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.institucioneducativa }}
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>ESTADO:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {{ institucioneducativa.estadoinstitucionTipo.estadoinstitucion|upper }}
                                                    </div>
                                                </div>
                                                {% if institucioneducativa.dependenciaTipo.id == 2 %}
                                                    <div class="form-group col-md-12">
                                                        <div class="col-md-6">
                                                            <strong>CONVENIO:</strong>
                                                        </div>
                                                        <div class="col-md-6">
                                                            {{ institucioneducativa.convenioTipo.convenio|upper }}
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                <div class="form-group col-md-12">
                                                    <div class="col-md-6">
                                                        <strong>TELÉFONO DE REFERENCIA:</strong>
                                                    </div>
                                                    <div class="col-md-6">
                                                        {% if sucursal %}{{ sucursal.telefono1 }}{% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- /.panel-body -->
                            </div>
                        </div>
                    </div>
                    {{ form_start(form,{ 'attr': {'id':'form','enctype':'multipart/form-data','onsubmit':'return validacion();'}}) }}
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="pull-left">
                                        <h3 class="panel-title">2. UBICACIÓN GEOGRÁFICA</h3>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- /.panel-heading -->
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="form-group col-md-6">
                                            <div class="form-group col-md-12" style="background:#E9F9FC">
                                                <h5><strong>Ubicación Geográfica (Censo 2012 - información
                                                        referencial) </strong></h5>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>DEPARTAMENTO:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ lugarTipo2012 ? lugarTipo2012.lugarTipo.lugarTipo.lugartipo.lugar|upper : '' }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>PROVINCIA:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ lugarTipo2012 ? lugarTipo2012.lugarTipo.lugarTipo.lugar|upper : '' }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>MUNICIPIO:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ lugarTipo2012 ? lugarTipo2012.lugartipo.lugar|upper : '' }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>COMUNIDAD:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ lugarTipo2012 ? lugarTipo2012.lugar|upper : '' }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>ZONA:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.zona|upper }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>DIRECCIÓN:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.direccion|upper }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>ÁREA GEOGRÁFICA ESTABLECIDA POR EL MUNICIPIO:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {# {% for a in form.area %}
                                                            <div class="col-md-6 rdio rdio-primary circle">
                                                                {{ form_widget(a) }}
                                                                {{ form_label(a) }}
                                                            </div>
                                                        {% endfor %} #}
                                                    {% if institucioneducativa.areaMunicipio == 'U' %}
                                                        URBANO
                                                    {% elseif institucioneducativa.areaMunicipio == 'R' %}
                                                        RURAL
                                                    {% else %}
                                                        NO DEFINIDO
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group col-md-12" style="background:#E9F9FC">
                                                <h5><strong>Ubicación Geográfica (Censo 2001 - R.U.E.)</strong></h5>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>DEPARTAMENTO:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.lugarTipoLocalidad.lugarTipo.lugarTipo.lugarTipo.lugartipo.lugar|upper }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>PROVINCIA:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.lugarTipoLocalidad.lugarTipo.lugarTipo.lugartipo.lugar }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>MUNICIPIO:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.lugarTipoLocalidad.lugarTipo.lugartipo.lugar }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>CANTÓN:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.lugarTipoLocalidad.lugarTipo.lugar }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>LOCALIDAD:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.lugarTipoLocalidad.lugar }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>ZONA:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.zona }}
                                                </div>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <div class="col-md-6">
                                                    <strong>DIRECCIÓN:</strong>
                                                </div>
                                                <div class="col-md-6">
                                                    {{ institucioneducativa.leJuridicciongeografica.direccion }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- /.panel-body -->
                            </div>
                        </div>
                    </div>
                    {# {{ form_start(form,{ 'attr': {'id':'form','enctype':'multipart/form-data'}}) }} #}
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="pull-left">
                                        <h3 class="panel-title">3. DATOS A MODIFICAR</h3>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- /.panel-heading -->
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="form-group col-md-12">
                                            <div class="col-md-2">
                                                {{ form_label(form.tramites) }}
                                            </div>
                                            <div class="col-md-3">
                                                {{ form_widget(form.tramites,{'attr':{'onchange':'buscarTramite(this.value,null)'}}) }}
                                                <input type='hidden' id='is_ejpa' value='{{ isEjpa }}'>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-md-12">
                                            <div class="table-responsive col-md-12">
                                                <div id="msg"></div>
                                                {{ form_widget(form.tr) }}
                                                <table class="table table-bordered table-striped" id="tabla">
                                                    <tr>
                                                        <th>Tipo de trámite</th>
                                                        <th>Dato antiguo</th>
                                                        <th>Dato nuevo</th>
                                                        <th>Requisitos</th>
                                                        <th>Eliminar</th>
                                                    </tr>
                                                </table>
                                                <div id="requisitos">
                                                </div>
                                                <div id="apertura">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- /.panel-body -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="pull-left">
                                        <h3 class="panel-title">4. JUSTIFICACIÓN DE LA MODIFICACIÓN</h3>
                                    </div>
                                    <div class="clearfix"></div>
                                </div><!-- /.panel-heading -->
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="form-group  col-md-12">
                                            <div class="col-md-3">
                                                <strong>JUSTIFICACIÓN:</strong>
                                            </div>
                                            <div class="col-md-9">
                                                {{ form_widget(form.observacion) }}
                                            </div>
                                        </div>
                                    </div>
                                </div><!-- /.panel-body -->
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer">
                        <div class="form-group col-md-3">
                            {{ form_label(form.guardar) }}
                            {{ form_widget(form.guardar, {'attr':{'class':'btn btn-primary'} }) }}
                            <a href="{{ path('wf_tramite_index') }}" class="btn btn-danger"> <i class="fa fa-ban"></i>
                                Cancelar </a>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    {{ form_end(form) }}
                </div><!-- /.end panel -->
            </div>
        </div>
    </div>
    {% if tramite %}
        {% include 'SieProcesosBundle:TramiteCea:requisitosHistorico.html.twig' with {'datos': datos[0].datos,'institucioneducativa':tramite.institucioneducativa} %}
    {% endif %}
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
            integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
            crossorigin=""></script>
    <script src="{{ asset('webprocesos/js/mapa.js') }}"></script>


    <script>
        $(document).ready(function () {
            $.fn.datepicker.dates['es'] = {
                days: ["Domingo", "Lunes", "Martes", "Miercoles", "Jueves", "Viernes", "Sabado"],
                daysShort: ["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
                daysMin: ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"],
                months: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
                monthsShort: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"],
                format: 'dd-mm-yyyy',
                titleFormat: "MM yyyy", /* Leverages same syntax as 'format' */
                weekStart: 0
            };
            $('.date').datepicker({
                orientation: "auto left",
                forceParse: false,
                autoclose: true,
                todayHighlight: true,
                language: 'es'
            });
            $('#form_tr').empty();
        });

        $('.date').keydown(function () {
            return false;
        });

        function siefusion(sie) {
            var formData = {
                idsiefusion: sie,
                iddistrito: '{{ institucioneducativa.leJuridicciongeografica.lugarTipoIdDistrito }}'
            };
            if (sie.length >= 8) {
                if (sie == '{{ institucioneducativa.id }}') {
                    alert('No puede cerrar definitivamente la Unidad Educativa para la que esta solicitando Ampliación de Nivel.');
                    $('#form_siefusion').val('');
                    return false;
                }
                $.ajax({
                    type: 'GET',
                    url: "{{ path('tramite_cea_buscar_rue') }}",
                    data: formData,
                    beforeSend: function () {
                        $('#msg').empty();
                    },
                    success: function (data) {
                        if (data.msg) {
                            $("#msg").append('<div class="alert alert-danger"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' + data.msg + '</div>');
                            $('#form_siefusion').val('');
                        } else {
                            //console.log(data);
                            $('#fusion').show();
                        }
                    },
                });
            } else {
                $('#fusion').hide();
            }
        }

        function siecomparte(sie) {
            var formData = {
                sie: sie,
                le: '{{ institucioneducativa.leJuridiccionGeografica.id }}',
                iddistrito: '{{ institucioneducativa.leJuridiccionGeografica.distritoTipo.id }}'
            };
            if (sie.length >= 8) {
                $.ajax({
                    type: 'GET',
                    url: "{{ path('tramite_cea_buscar_ruecomparte') }}",
                    data: formData,
                    beforeSend: function () {
                        $('#msgcomparte').empty();
                        $('#ie').empty();
                        $('#org').empty();
                        $('#dependencia').empty();
                    },
                    success: function (data) {
                        //console.log(data);
                        if (data.msg) {
                            $("#msgcomparte").append('<div class="alert alert-danger"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' + data.msg + '</div>');
                            $('#form_siecomparte').val('');
                        } else {
                            $('#ie').append(data.institucioneducativa);
                            $('#org').append(data.subsistema);
                            $('#dependencia').append(data.dependencia);
                            $('#form_lejurisdiccion').val(data.codigole);
                            buscarEdificioEscolar($('#form_lejurisdiccion').val());
                        }
                    },
                });
            } else {
                $('#ie').empty();
                $('#org').empty();
                $('#dependencia').empty();
                $('#form_lejurisdiccion').val('');
                buscarEdificioEscolar('-1');
            }
        }

        function buscarEdificioEscolar(idLe) {
            if (idLe.length >= 8 && idLe != '{{ institucioneducativa.leJuridicciongeografica.id }}') {
                var formData = {
                    idLe: idLe,
                    iddistrito: '{{ institucioneducativa.leJuridicciongeografica.distritoTipo.id }}'
                };
                $.ajax({
                    type: 'get',
                    url: "{{ path('tramite_cea_buscar_edificio') }}",
                    data: formData,
                    beforeSend: function () {
                        //$("#form_departamento2012").empty();
                        $("#form_provincia2012").empty();
                        $("#form_municipio2012").empty();
                        $("#form_comunidad2012").empty();
                        //$("#form_departamento2001").empty();
                        $("#form_provincia2001").empty();
                        $("#form_municipio2001").empty();
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        $("#form_zona").empty();
                        $("#form_direccion").empty();
                        //$("#form_departamento2012").append('<option value="">Buscando...</option>');
                        $("#form_provincia2012").append('<option value="">Buscando...</option>');
                        $("#form_municipio2012").append('<option value="">Buscando...</option>');
                        $("#form_comunidad2012").append('<option value="">Buscando...</option>');
                        //$("#form_departamento2001").append('<option value="">Buscando...</option>');
                        $("#form_provincia2001").append('<option value="">Buscando...</option>');
                        $("#form_municipio2001").append('<option value="">Buscando...</option>');
                        $("#form_canton2001").append('<option value="">Buscando...</option>');
                        $("#form_localidad2001").append('<option value="">Buscando...</option>');
                        $("#form_zona").val('');
                        $("#form_direccion").val('');
                        $("#msg").empty();
                    },
                    success: function (data) {
                        //console.log(data);
                        if (data.msg) {
                            $("#form_lejurisdiccion").val('');
                            //$("#form_departamento2012").empty();
                            //$("#form_departamento2012").append('<option value="">Seleccione...</option>');
                            $("#form_provincia2012").empty();
                            $("#form_municipio2012").empty();
                            $("#form_comunidad2012").empty();
                            //$("#form_departamento2001").empty();
                            //$("#form_departamento2001").append('<option value="">Seleccione...</option>');
                            $("#form_provincia2001").empty();
                            $("#form_municipio2001").empty();
                            $("#form_canton2001").empty();
                            $("#form_localidad2001").empty();
                            $("#form_zona").val('');
                            $("#form_direccion").val('');
                            /*$.each(data.lugar.c2012.dep.lista, function (i, value) {
                                $("#form_departamento2012").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2001.dep.lista, function (i, value) {
                                $("#form_departamento2001").append('<option value="' + i + '">' + value + '</option>');
                            });*/
                            $('#form_departamento2012').removeAttr('style');
                            $("#form_provincia2012").removeAttr('style');
                            $("#form_municipio2012").removeAttr('style');
                            $("#form_comunidad2012").removeAttr('style');
                            $("#form_departamento2001").removeAttr('style');
                            $("#form_provincia2001").removeAttr('style');
                            $("#form_municipio2001").removeAttr('style');
                            $("#form_canton2001").removeAttr('style');
                            $("#form_localidad2001").removeAttr('style');
                            $('#form_zona').removeAttr('style');
                            $('#form_direccion').removeAttr('style');
                            $("#msg").append('<div class="alert alert-danger"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' + data.msg + '</div>');
                        } else {
                            /*$.each(data.lugar.c2012.dep.lista, function (i, value) {
                                $("#form_departamento2012").append('<option value="' + i + '">' + value + '</option>');
                            });*/
                            $.each(data.lugar.c2012.prov.lista, function (i, value) {
                                $("#form_provincia2012").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2012.mun.lista, function (i, value) {
                                $("#form_municipio2012").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2012.comu.lista, function (i, value) {
                                $("#form_comunidad2012").append('<option value="' + i + '">' + value + '</option>');
                            });
                            /*$.each(data.lugar.c2001.dep.lista, function (i, value) {
                                $("#form_departamento2001").append('<option value="' + i + '">' + value + '</option>');
                            });*/
                            $.each(data.lugar.c2001.prov.lista, function (i, value) {
                                $("#form_provincia2001").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2001.mun.lista, function (i, value) {
                                $("#form_municipio2001").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2001.can.lista, function (i, value) {
                                $("#form_canton2001").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $.each(data.lugar.c2001.loc.lista, function (i, value) {
                                $("#form_localidad2001").append('<option value="' + i + '">' + value + '</option>');
                            });
                            $("#form_departamento2012").val(data.lugar.c2012.dep.id);
                            $("#form_provincia2012").val(data.lugar.c2012.prov.id);
                            $("#form_municipio2012").val(data.lugar.c2012.mun.id);
                            $("#form_comunidad2012").val(data.lugar.c2012.comu.id);
                            $("#form_departamento2001").val(data.lugar.c2001.dep.id);
                            $("#form_provincia2001").val(data.lugar.c2001.prov.id);
                            $("#form_municipio2001").val(data.lugar.c2001.mun.id);
                            $("#form_canton2001").val(data.lugar.c2001.can.id);
                            $("#form_localidad2001").val(data.lugar.c2001.loc.id);
                            $("#form_zona").val(data.lugar.zona);
                            $("#form_direccion").val(data.lugar.direccion);
                            $('#form_departamento2012').css('pointer-events', 'none');
                            $("#form_provincia2012").css('pointer-events', 'none');
                            $("#form_municipio2012").css('pointer-events', 'none');
                            $("#form_comunidad2012").css('pointer-events', 'none');
                            $("#form_departamento2001").css('pointer-events', 'none');
                            $("#form_provincia2001").css('pointer-events', 'none');
                            $("#form_municipio2001").css('pointer-events', 'none');
                            $("#form_canton2001").css('pointer-events', 'none');
                            $("#form_localidad2001").css('pointer-events', 'none');
                            $('#form_zona').css('pointer-events', 'none');
                            $('#form_direccion').css('pointer-events', 'none');
                        }
                    }
                });
            } else {
                $('#ie').empty();
                $('#org').empty();
                $('#dependencia').empty();
                if ($('#ie').html() == '' && idLe != '-1') {
                    $('#form_siecomparte').val('');
                }
                $("#form_departamento2012").val('');
                $('#form_departamento2012 option[value=""]').text("Seleccione departamento");
                $("#form_provincia2012").empty();
                $("#form_municipio2012").empty();
                $("#form_comunidad2012").empty();
                $("#form_departamento2001").val('');
                $('#form_departamento2001 option[value=""]').text("Seleccione departamento");
                $("#form_provincia2001").empty();
                $("#form_municipio2001").empty();
                $("#form_canton2001").empty();
                $("#form_localidad2001").empty();
                $("#form_zona").val('');
                $("#form_direccion").val('');
                $('#form_departamento2012').removeAttr('style');
                $("#form_provincia2012").removeAttr('style');
                $("#form_municipio2012").removeAttr('style');
                $("#form_comunidad2012").removeAttr('style');
                $("#form_departamento2001").removeAttr('style');
                $("#form_provincia2001").removeAttr('style');
                $("#form_municipio2001").removeAttr('style');
                $("#form_canton2001").removeAttr('style');
                $("#form_localidad2001").removeAttr('style');
                $('#form_zona').removeAttr('style');
                $('#form_direccion').removeAttr('style');
                if (idLe == '{{ institucioneducativa.leJuridicciongeografica.id }}') {
                    $("#form_lejurisdiccion").val('');
                    alert('El Código Edificio Educativo debe ser diferente al actual.')
                }
            }

        }

        function provincia(d, censo) {
            if (censo == 2001 && $('#form_departamento2012').val() != '') {
                if ($('#form_departamento2001 option:selected').text() != $('#form_departamento2012 option:selected').text()) {
                    alert('El departamento del Censo 2001 no puede ser diferente del departamento del Censo 2012');
                    $('#form_departamento2001').val('');
                    return false;
                }
            }

            if (censo == 2012 && $('#form_departamento2001').val() != '') {
                if ($('#form_departamento2001 option:selected').text() != $('#form_departamento2012 option:selected').text()) {
                    alert('El departamento del Censo 2012 no puede ser diferente del departamento del Censo 2001');
                    $('#form_departamento2012').val('');
                    return false;
                }
            }

            $("#form_lejurisdiccion").val('');
            $("#form_siecomparte").val('');
            $('#ie').empty();
            $('#org').empty();
            $('#dependencia').empty();
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_provincias', {'idDepartamento': d, 'censo': censo}),
                beforeSend: function () {
                    $("#form_lejurisdiccion").val('');
                    if (censo == 2001) {
                        $("#form_provincia2001").empty();
                        $("#form_municipio2001").empty();
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        //$("#form_distrito2001").empty();
                        $("#form_provincia2001").append('<option value="">Buscando...</option>');
                        $("#form_municipio2001").append('<option value="">Buscando...</option>');
                        $("#form_canton2001").append('<option value="">Buscando...</option>');
                        $("#form_localidad2001").append('<option value="">Buscando...</option>');
                        //$("#form_distrito2001").append('<option value="">Buscando...</option>');
                    } else if (censo == 2012) {
                        $("#form_provincia2012").empty();
                        $("#form_municipio2012").empty();
                        $("#form_comunidad2012").empty();
                        //$("#form_distrito2012").empty();
                        $("#form_provincia2012").append('<option value="">Buscando...</option>');
                        $("#form_municipio2012").append('<option value="">Buscando...</option>');
                        $("#form_comunidad2012").append('<option value="">Buscando...</option>');
                        //$("#form_distrito2012").append('<option value="">Buscando...</option>');
                    }

                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_provincia2001").empty();
                        $("#form_municipio2001").empty();
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        //$("#form_distrito2001").empty();
                        $("#form_provincia2001").append('<option value="">Seleccionar...</option>');
                        $("#form_provincia2001").attr('required', true);
                        $("#form_municipio2001").append('<option value="">Seleccionar...</option>');
                        $("#form_municipio2001").attr('required', true);
                        $("#form_canton2001").append('<option value="">Seleccionar...</option>');
                        $("#form_canton2001").attr('required', true);
                        $("#form_localidad2001").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad2001").attr('required', true);
                        //$("#form_distrito2001").append('<option value="">Seleccionar...</option>');
                        $.each(data.provincia, function (i, value) {
                            $("#form_provincia2001").append('<option value="' + i + '">' + value + '</option>');
                        });
                        /*$.each(data.distrito, function (i, value) {
                            $("#form_distrito").append('<option value="' + i + '">' + value + '</option>');
                        });*/
                    } else if (censo == 2012) {
                        $("#form_provincia2012").empty();
                        $("#form_municipio2012").empty();
                        $("#form_comunidad2012").empty();
                        //$("#form_distrito2012").empty();
                        $("#form_provincia2012").append('<option value="">Seleccionar...</option>');
                        $("#form_provincia2012").attr('required', true);
                        $("#form_municipio2012").append('<option value="">Seleccionar...</option>');
                        $("#form_municipio2012").attr('required', true);
                        $("#form_comunidad2012").append('<option value="">Seleccionar...</option>');
                        $("#form_comunidad2012").attr('required', true);
                        //$("#form_distrito2012").append('<option value="">Seleccionar...</option>');
                        $.each(data.provincia, function (i, value) {
                            $("#form_provincia2012").append('<option value="' + i + '">' + value + '</option>');
                        });
                        /*$.each(data.distrito, function (i, value) {
                            $("#form_distrito").append('<option value="' + i + '">' + value + '</option>');
                        });*/
                    }

                }
            });
        }

        function provincia2(d, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_provincias', {'idDepartamento': d, 'censo': censo}),
                beforeSend: function () {
                    $("#form_lejurisdiccion").val('');
                    if (censo == 2001) {
                        $("#form_provincia").empty();
                        $("#form_municipio").empty();
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        $("#form_provincia").append('<option value="">Buscando...</option>');
                        $("#form_municipio").append('<option value="">Buscando...</option>');
                        $("#form_canton").append('<option value="">Buscando...</option>');
                        $("#form_localidad").append('<option value="">Buscando...</option>');
                        //$("#form_distrito2001").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_provincia").empty();
                        $("#form_municipio").empty();
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        //$("#form_distrito2001").empty();
                        $("#form_provincia").append('<option value="">Seleccionar...</option>');
                        $("#form_provincia").attr('required', true);
                        $("#form_municipio").append('<option value="">Seleccionar...</option>');
                        $("#form_municipio").attr('required', true);
                        $("#form_canton").append('<option value="">Seleccionar...</option>');
                        $("#form_canton").attr('required', true);
                        $("#form_localidad").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad").attr('required', true);
                        $.each(data.provincia, function (i, value) {
                            $("#form_provincia").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function municipio(p, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_municipios', {'idProvincia': p, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_municipio2001").empty();
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        $("#form_municipio2001").append('<option value="">Buscando...</option>');
                        $("#form_canton2001").append('<option value="">Buscando...</option>');
                        $("#form_localidad2001").append('<option value="">Buscando...</option>');
                    } else if (censo == 2012) {
                        $("#form_municipio2012").empty();
                        $("#form_comunidad2012").empty();
                        $("#form_municipio2012").append('<option value="">Buscando...</option>');
                        $("#form_comunidad2012").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_municipio2001").empty();
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        $("#form_municipio2001").append('<option value="">Seleccionar...</option>');
                        $("#form_canton2001").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad2001").append('<option value="">Seleccionar...</option>');
                        $.each(data.municipio, function (i, value) {
                            $("#form_municipio2001").append('<option value="' + i + '">' + value + '</option>');
                        });
                    } else if (censo == 2012) {
                        $("#form_municipio2012").empty();
                        $("#form_comunidad2012").empty();
                        $("#form_municipio2012").append('<option value="">Seleccionar...</option>');
                        $("#form_comunidad2012").append('<option value="">Seleccionar...</option>');
                        $.each(data.municipio, function (i, value) {
                            $("#form_municipio2012").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function municipio2(p, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_municipios', {'idProvincia': p, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_municipio").empty();
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        $("#form_municipio").append('<option value="">Buscando...</option>');
                        $("#form_canton").append('<option value="">Buscando...</option>');
                        $("#form_localidad").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_municipio").empty();
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        $("#form_municipio").append('<option value="">Seleccionar...</option>');
                        $("#form_canton").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad").append('<option value="">Seleccionar...</option>');
                        $.each(data.municipio, function (i, value) {
                            $("#form_municipio").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function comunidad(p, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_comunidad', {'idMunicipio': p, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2012) {
                        $("#form_comunidad2012").empty();
                        $("#form_comunidad2012").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2012) {
                        $("#form_comunidad2012").empty();
                        $("#form_comunidad2012").append('<option value="">Seleccionar...</option>');
                        $.each(data.comunidad, function (i, value) {
                            $("#form_comunidad2012").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function comunidad2(p, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_comunidad', {'idMunicipio': p, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2012) {
                        $("#form_comunidad2012").empty();
                        $("#form_comunidad2012").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2012) {
                        $("#form_comunidad2012").empty();
                        $("#form_comunidad2012").append('<option value="">Seleccionar...</option>');
                        $.each(data.comunidad, function (i, value) {
                            $("#form_comunidad2012").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function canton(m, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_cantones', {'idMunicipio': m, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        $("#form_canton2001").append('<option value="">Buscando...</option>');
                        $("#form_localidad2001").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_canton2001").empty();
                        $("#form_localidad2001").empty();
                        $("#form_canton2001").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad2001").append('<option value="">Seleccionar...</option>');
                        $.each(data.canton, function (i, value) {
                            $("#form_canton2001").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function canton2(m, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_cantones', {'idMunicipio': m, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        $("#form_canton").append('<option value="">Buscando...</option>');
                        $("#form_localidad").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_canton").empty();
                        $("#form_localidad").empty();
                        $("#form_canton").append('<option value="">Seleccionar...</option>');
                        $("#form_localidad").append('<option value="">Seleccionar...</option>');
                        $.each(data.canton, function (i, value) {
                            $("#form_canton").append('<option value="' + i + '">' + value + '</option>');
                        });
                    }
                }
            });
        }

        function localidad(c, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_localidades', {'idCanton': c, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_localidad2001").empty();
                        $("#form_localidad2001").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_localidad2001").empty();
                        $("#form_localidad2001").append('<option value="">Seleccionar...</option>');
                        $.each(data.localidad, function (i, value) {
                            $("#form_localidad2001").append('<option value="' + i + '">' + value + '</option>');
                        });
                        $("#form_localidad2001").selectpicker('refresh');
                    }
                }
            });
        }

        function localidad2(c, censo) {
            $.ajax({
                type: 'get',
                url: Routing.generate('tramite_cea_le_buscar_localidades', {'idCanton': c, 'censo': censo}),
                beforeSend: function () {
                    if (censo == 2001) {
                        $("#form_localidad").empty();
                        $("#form_localidad").append('<option value="">Buscando...</option>');
                    }
                },
                success: function (data) {
                    if (censo == 2001) {
                        $("#form_localidad").empty();
                        $("#form_localidad").append('<option value="">Seleccionar...</option>');
                        $.each(data.localidad, function (i, value) {
                            $("#form_localidad").append('<option value="' + i + '">' + value + '</option>');
                        });
                        //$("#form_localidad").selectpicker('refresh');
                    }
                }
            });
        }

        $(function () {
            $(".validar").keydown(function (event) {
                if ((event.keyCode < 48 || event.keyCode > 57) && (event.keyCode < 96 || event.keyCode > 105) && event.keyCode !== 190 && event.keyCode !== 110 && event.keyCode !== 8 && event.keyCode !== 9) {
                    return false;
                }
            });
        });

        function buscarTramite(id, tipo) {
            if (id) {
                if (($('#tabla tr').length - 1) == 0) {
                    $('#form_tr').val('');
                }
                if (id == 39) { //fusion
                    idtramite = 34; //ampliacion de nivel
                    tipo = 'fusion'
                } else if (id == 40) {
                    idtramite = 71; //reduccion de nivel
                    tipo = 'desglose'
                } else {
                    idtramite = id;
                }
                //alert(id);
                var tramitetipo = $('#form_tramites option:selected').text();
                if ($("#fila_" + idtramite).length && id == 39) {
                    alert('Elimine la Ampliación de Nivel para poder solicitar la ' + tramitetipo);
                    return false;
                }
                if ($("#fila_" + idtramite).length && id == 40) {
                    alert('Elimine la Reducción de Nivel para poder solicitar la ' + tramitetipo);
                    return false;
                }
                if ($("#fila_" + idtramite).length) {
                    alert('Ya seleccionó ' + tramitetipo);
                    return false;
                }
                if (idtramite == 71) {
                    if (JSON.parse($('#nivel').val()).length == 1) {
                        alert('La Unidad Educativa solo cuenta con un Nivel, por lo que no corresponde una Reducción de Nivel.');
                        return false;
                    }
                }
                if ((id == 69 || id == 68) && ($('#tabla tr').length - 1) > 0 && JSON.parse($('#form_tr').val()).includes(39) == false) {
                    alert('El ' + tramitetipo + ', no corresponde si modificará otros datos.Entra' + id);
                    return false;
                }
                if ($('#form_tr').val() != "" && JSON.parse($('#form_tr').val()).includes(39) == true && id == 69) {
                    alert('El ' + tramitetipo + ', no corresponde si modificará otros datos.');
                    return false;
                }
                if ($('#form_tr').val() != "" && (JSON.parse($('#form_tr').val()).includes(69) || JSON.parse($('#form_tr').val()).includes(68)) && JSON.parse($('#form_tr').val()).includes(39) == false) {
                    alert('No puede realizar otras modificaciones si esta solicitando Cierre de la Unidad Educativa.');
                    return false;
                }

                var formData = {id: idtramite, tipo: tipo, ie: '{{ institucioneducativa.id }}'};
                $.ajax({
                    type: 'GET',
                    url: "{{ path('tramite_cea_busca_tarea') }}",
                    data: formData,
                    beforeSend: function () {
                    },
                    success: function (data) {
                        var tr = '<tr id="fila_' + idtramite + '">' + data;
                        if (idtramite == 44 && {{ institucioneducativa.estadoinstitucionTipo.id }} == 10) {
                            tr = tr + '<td></td>';
                        } else {
                            tr = tr + '<td align="center"><button type="button" class="btn btn-xs btn-success" data-toggle="modal" data-target="#modal_' + idtramite + '" data-placement="top" title="Registrar los requisitos del trámite" onclick="requisitos(' + idtramite + ')"><i class="glyphicon glyphicon-plus"></i></button>' +
                                '</td>';
                        }
                        tr = tr + '<td align="center"><button type="button" class="btn btn-xs btn-danger" data-placement="top" title="Eliminar trámite" onclick="borrarFila(' + idtramite + ')"><i class="glyphicon glyphicon-minus"></i></button>' +
                            '</td></tr>';
                        $('#tabla').append(tr);
                        $('#requisitos').append('<div class="modal fade borrar"  role="dialog" aria-hidden="true" id="modal_' + idtramite + '" data-backdrop="false" style="z-index:2147483646 !important; background-color: rgba(0, 0, 0, 0.5);"></div>');

                        if ($('#form_tr').val() == "" && id != 39 && id != 40 && id != 63) {
                            trArray = [Number(idtramite)];
                            $('#form_tr').val(JSON.stringify(trArray));
                        } else if ($('#form_tr').val() == "" && (id == 39 || id == 40 || id == 63)) {
                            trArray = [Number(id), Number(idtramite)];
                            $('#form_tr').val(JSON.stringify(trArray));
                            if (tipo == 'fusion') {
                                buscarTramite(43, tipo);
                            } else {
                                $('#apertura').append('<div class="modal fade borrar"  role="dialog" aria-hidden="true" id="modal_apertura" data-backdrop="false" style="z-index:2147483647 !important; background-color: rgba(0, 0, 0, 0.5);"></div>');
                                //buscarTramite(54, tipo);
                            }
                        } else if ($('#form_tr').val() != "" && (id == 39 || id == 40)) {
                            trArray = JSON.parse($('#form_tr').val());
                            trArray.push(Number(id));
                            trArray.push(Number(idtramite));
                            $('#form_tr').val(JSON.stringify(trArray));
                            if (tipo == 'fusion') {
                                buscarTramite(43, tipo);
                            } else {
                                buscarTramite(54, tipo);
                            }
                        } else {
                            trArray = JSON.parse($('#form_tr').val());
                            trArray.push(Number(idtramite));
                            $('#form_tr').val(JSON.stringify(trArray));
                        }
                        $('[data-toggle="tooltip"]').tooltip();
                        $('[type="button"]').tooltip();
                    },
                });
            }
        }

        function validarnombre(nombre, tipo) {
            nombre = nombre.toUpperCase();
            //alert(nombre);
            var generico = ['ESCUELA', 'COLEGIO', 'FISCAL', 'CONVENIO', 'PRIVADA', 'PRIVADO', 'KINDER', 'INSTITUTO', 'CENTRO INTEGRADO', 'TECNICO TECNOLOGICO', 'TÉCNICO TECNOLOGICO', 'TÉCNICO TECNOLÓGICO', 'TÉCNICO TECNOLÓGICO', 'HUMANISTICO', 'HUMANÍSTICO'];
            $.each(generico, function (index, value) {
                if (nombre.search(value) != -1) {
                    if (tipo == 0) {
                        $('#form_institucioneducativa').val('');
                    } else {
                        $('#form_nuevo_nombre').val('');
                    }
                    alert('El nombre de la Unidad Educativa no puede llevar el denominativo genérico: ' + value);
                }
            });
        }

        function validarnombredistrito(nombre) {
            var ie = ('{{ institucioneducativa.institucioneducativa }}').trim();
            nombre = nombre.toUpperCase().trim();
            if (nombre != '') {
                if (nombre.toUpperCase() == ie.toUpperCase()) {
                    alert('No puede ingresar el mismo nombre para la unidda educativa.');
                    $('#form_nuevo_nombre').val('');
                    return false;
                }
                var formData = {
                    sie: '{{ institucioneducativa.id }}',
                    nuevo_nombre: nombre,
                    iddistrito: '{{ institucioneducativa.leJuridicciongeografica.distritoTipo.id }}'
                };
                $.ajax({
                    type: 'POST',
                    url: "{{ path('tramite_cea_validarnombredistrito') }}",
                    data: formData,
                    beforeSend: function () {
                        $('#msg').empty();
                    },
                    success: function (data) {
                        //console.log(data);
                        if (data.id) {
                            $("#msg").append('<div class="alert alert-danger"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>' + data.msg + '</div>');
                            $('#form_nuevo_nombre').val('');
                        }
                    },
                });
            }
        }

        function requisitos(id) {
            //alert(id);
            if ($("#modal_requisitos_" + id).length) {
                return false;
            }

            if (id != 54 && id != 55 && id != 46) {
                var formData = {id: id, ie: '{{ institucioneducativa.id }}'};
            } else {
                if (id == 54 && ($('#form_dependencia').length == 0 || $('#form_dependencia').val() == '')) {
                    alert('Primero debe registrar y validar los datos de la nueva Unidad Educativa.');
                    $('#modal_' + id).modal('toggle');
                    return false;
                }
                if (id == 54) {
                    var formData = {id: id, dependencia: $('#form_dependencia').val(), constitucion: 1};
                } else {
                    var formData = {
                        id: id,
                        dependencia: '{{ institucioneducativa.dependenciaTipo.id }}',
                        constitucion: 1
                    };
                }
            }

            $.ajax({
                type: 'GET',
                url: "{{ path('tramite_cea_busca_requisitos') }}",
                data: formData,
                beforeSend: function () {
                    $('#modal_' + id).empty();
                    $("#modal_" + id).append('<div style="text-align:center">Cargango datos...<img src="{{ asset('img/loading.gif') }}"  /></div>');
                },
                success: function (data) {
                    //console.log(data);
                    $('#modal_' + id).empty();
                    $('#modal_' + id).append(data);
                    $('.date').datepicker({
                        orientation: "auto left",
                        forceParse: false,
                        autoclose: true,
                        todayHighlight: true,
                        language: 'es'
                    });
                },
            });
        }

        function verRequisitos(id) {
            //alert(id);
            var formData = {id: id, ie: '{{ institucioneducativa.id }}'};
            if ($("#modal_requisitos_" + id).length) {
                return false;
            }
            $.ajax({
                type: 'GET',
                url: "{{ path('tramite_cea_busca_requisitos') }}",
                data: formData,
                beforeSend: function () {
                    $('#modal_' + id).empty();
                    $("#modal_" + id).append('<div style="text-align:center">Cargango datos...<img src="{{ asset('img/loading.gif') }}"  /></div>');
                },
                success: function (data) {
                    //console.log(data);
                    $('#modal_' + id).empty();
                    $('#modal_' + id).append(data);
                    $('.date').datepicker({
                        orientation: "auto left",
                        forceParse: false,
                        autoclose: true,
                        todayHighlight: true,
                        language: 'es'
                    });
                },
            });
        }

        function verificarRequisitos(id, dependenciaId, constitucion) {
            switch (id) {
                case 62: //ampliacion de nivel
                    if ($('#form_i_solicitud_ampliar').val() == '') {
                        alert('Debe adjuntar la solicitud de ampliacion de nivel.');
                        return false;
                    } else if ($('#form_i_compromiso_ampliar').is(':checked') == false) {
                        alert('Seleccione la presentación original de Compromiso del Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_i_certificado_ampliar').is(':checked') == false) {
                        alert('Seleccione la presentación original de Certificado RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_ampliar').is(':checked') == false) {
                        alert('Seleccione la presentación original del Certificado de Acreditación de Servicio Educativo.');
                        return false;
                    } else if ($('#form_i_folio_ampliar').is(':checked') == false) {
                        alert('Seleccione la presentación de la copia legalizada del Folio Real actualizado.');
                        return false;
                    } else if ($('#form_ii_planos_ampliar').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación de planos aprobados por el Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_ii_edificio_ampliar').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación original de Formulario de Edificio Escolar.');
                        return false;
                    } else if ($('#form_ii_geografica_ampliar').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación original del Formulario de Actualización Geográfica.');
                        return false;
                    } else if ($('#form_ii_equipamiento_ampliar').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione Detalle de equipamiento.');
                        return false;
                    } else if ($('#form_iii_curri_proy_ampliar').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación de Proyecto Educativo.');
                        return false;
                    } else if ($('#form_iii_curri_informe_ampliar').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación original de Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 63: //apertura subcentro
                    if ($('#form_i_informe_director_cea_sc').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe técnico de apertura.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><i class="glyphicon glyphicon-ok"></i>Requisitos validados con éxito.</div>');
                    }
                    break;
                case 71: //Reduccion de Nivel
                    if ($('#form_i_solicitud_reducir').val() == '') {
                        alert('Debe adjuntar la solicitud de reducción de nivel.');
                        return false;
                    } else if ($('#form_i_compromiso_reducir').is(':checked') == false) {
                        alert('Seleccione la presentación original de Compromiso del Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_i_certificado_reducir').is(':checked') == false) {
                        alert('Seleccione la presentación original de Certificado RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_reducir').is(':checked') == false) {
                        alert('Seleccione la presentación original del Certificado de Acreditación de Servicio Educativo.');
                        return false;
                    } else if ($('#form_i_folio_reducir').is(':checked') == false) {
                        alert('Seleccione la presentación de la copia legalizada del Folio Real actualizado.');
                        return false;
                    } else if ($('#form_ii_planos_reducir').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación de planos aprobados por el Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_ii_edificio_reducir').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación original de Formulario de Edificio Escolar.');
                        return false;
                    } else if ($('#form_ii_geografica_reducir').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación original del Formulario de Actualización Geográfica.');
                        return false;
                    } else if ($('#form_ii_equipamiento_reducir').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione Detalle de equipamiento.');
                        return false;
                    } else if ($('#form_iii_curri_proy_reducir').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación de Proyecto Educativo.');
                        return false;
                    } else if ($('#form_iii_curri_informe_reducir').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación original de Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 61: //Ampliación o cambio de especialidades técnicas
                    if ($('#form_i_solicitud_acesp').val() == '') {
                        alert('Debe adjuntar la solicitud de ampliación o cambio de especialidades técnicas.');
                        return false;
                    } else if ($('#form_i_compromiso_acesp').is(':checked') == false) {
                        alert('Seleccione la presentación original de Compromiso del Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_i_certificado_acesp').is(':checked') == false) {
                        alert('Seleccione la presentación original de Certificado RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_acesp').is(':checked') == false) {
                        alert('Seleccione la presentación original del Certificado de Acreditación de Servicio Educativo.');
                        return false;
                    } else if ($('#form_ii_edificio_acesp').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación original de Formulario de Edificio Escolar.');
                        return false;
                    } else if ($('#form_ii_equipamiento_acesp').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione Detalle de equipamiento.');
                        return false;
                    } else if ($('#form_iii_curri_proy_acesp').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación de Proyecto Educativo.');
                        return false;
                    } else if ($('#form_iii_curri_informe_acesp').is(':checked') == false) {
                        alert('En el punto 3.Requisitos Técnico - Pedagógicos, seleccione la presentación original de Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 67: //Cierre de Especialidades Técnicas
                    if ($('#form_i_informe_director_cea_cesp').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe técnico de la Dirección del Centro de Educación Alternativa.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 64: //cambio de dependencia
                    if ($('#form_i_solicitud_dependencia').val() == '') {
                        alert('Debe adjuntar la solicitud de Cambio de Dependencia.');
                        return false;
                    } else if ($('#form_i_certificadorue_dependencia').is(':checked') == false) {
                        alert('Seleccione la presentación del Certificado de Registro de Unidades Educativas – RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_dependencia').is(':checked') == false) {
                        alert('Seleccione la presentación del Certificado de Acreditación de Servicio Educativo.');
                        return false;
                    } else if ($('#form_ii_planos_dependencia').is(':checked') == false) {
                        alert('Seleccione la presentación de los Planos aprobados por el Gobierno Autónomo Municipal correspondiente.');
                        return false;
                    }
                    if (dependenciaId == 1) {
                        if ($('#form_i_folio_dependencia').is(':checked') == false) {
                            alert('Seleccione la presentación del Folio Real actualizado emitido por Derechos Reales o Testimonio de Propiedad de la Matricula Computarizada.');
                            return false;
                        } else if ($('#form_ii_edificio_dependencia').is(':checked') == false) {
                            alert('Seleccione la presentación del Formulario de Edificio Escolar.');
                            return false;
                        } else if ($('#form_ii_geografica_dependencia').is(':checked') == false) {
                            alert('Seleccione la presentación del Formulario de Actualización Geográfica.');
                            return false;
                        }
                    }
                    if ($('#form_iii_informe_director_cea_dependencia').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe Técnico del Director/a del CEA.');
                        return false;
                    } else if ($('#form_iii_informe_distrital_dependencia').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 70: //cambio de nombre
                    if ($('#form_i_solicitud_cn').val() == '') {
                        alert('Debe adjuntar la solicitud de Modificación de denominación.');
                        return false;
                    }
                    if ($('#form_i_certdefuncion_cn').val() == '') {
                        alert('Debe adjuntar el Certificado de Defunción.');
                        return false;
                    }
                    if ($('#form_i_certificadorue_cn').is(':checked') == false) {
                        alert('Seleccione la presentación del Original del Certificado RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_cn').is(':checked') == false) {
                        alert('Seleccione la presentación del Original o copia legalizada de Certificado de Acreditación de Servicio Educativo.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 66: //cambio de jurisdiccion administrativa
                    if ($('#form_i_solicitud_jur').val() == '') {
                        alert('Debe adjuntar la solicitud de cambio de jurisdicción administrativa.');
                        return false;
                    } else if ($('#form_i_compromiso_jur').is(':checked') == false) {
                        alert('Seleccione el Documento del Gobierno Autónomo Municipal que autorice y comprometa la dotación y mantenimiento de la infraestructura, mobiliario, equipamiento y atención de servicios básicos.');
                        return false;
                    } else if ($('#form_i_certificadorue_jur').is(':checked') == false) {
                        alert('Seleccione la presentación del Original de Certificado RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_jur').is(':checked') == false) {
                        alert('Seleccione la presentación del Original o copia legalizada de Certificado de Acreditación de Servicios Educativos.');
                        return false;
                    } else if ($('#form_i_conformidad_jur').is(':checked') == false) {
                        alert('Seleccione la presentación del Acta de conformidad firmada por las/los Directores Distritales Educativos.');
                        return false;
                    } else if ($('#form_ii_planos_jur').is(':checked') == false) {
                        alert('En el punto 2. Requisitos de Infraestructura, seleccione la presentación de Planos aprobados por el Gobierno Autónomo Municipal.');
                        return false;
                    } else if ($('#form_ii_edificio_jur').is(':checked') == false) {
                        alert('En el punto 2. Requisitos de Infraestructura, seleccione la presentación del Formulario de Edificio Escolar.');
                        return false;
                    } else if ($('#form_ii_geografica_jur').is(':checked') == false) {
                        alert('En el punto 2. Requisitos de Infraestructura, seleccione la presentación del Formulario de Actualización Geográfica.');
                        return false;
                    } else if ($('#form_iii_informe_distrital_jur').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Técnico - Pedagógicos, seleccione la presentación del Original de Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 39: //Fusion
                    break;
                case 40: //desglose
                    break;
                case 65: //cambio de infraestructura
                    if ($('#form_i_solicitud_infra').val() == '') {
                        alert('Debe adjuntar la Solicitud de Cambio de Infraestructura.');
                        return false;
                    } else if ($('#form_i_compromiso_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Documento del Gobierno Autónomo Municipal que autorice y comprometa la dotación y mantenimiento de la infraestructura, mobiliario, equipamiento y atención de servicios básicos..');
                        return false;
                    } else if ($('#form_i_certificadorue_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Certificado de Registro de Unidades Educativas – RUE.');
                        return false;
                    } else if ($('#form_i_acreditacion_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Certificado de Acreditación de Servicios Educativos.');
                        return false;
                    } else if ($('#form_ii_planos_infra').is(':checked') == false) {
                        alert('Seleccione la presentación de Planos aprobados por el Gobierno Autónomo Municipal correspondiente.');
                        return false;
                    } else if ($('#form_ii_edificio_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Formulario de Edificio Escolar.');
                        return false;
                    } else if ($('#form_ii_geografica_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Formulario de Actualización Geográfica.');
                        return false;
                    } else if ($('#form_iii_informe_distrital_infra').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe Técnico del Director Distrital de Educación.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 69: //cierre temporal
                    if ($('#form_i_informe_director_cea_cierre_tmp').is(':checked') == false) {
                        alert('Seleccione la presentación del Informe técnico, emitido por la o el Director del CEA que justifique el cierre temporal del Centro de Educación Alternativa.');
                        return false;
                    } else if ($('#form_i_certificadorue_cierre_tmp').is(':checked') == false) {
                        alert('Seleccione la presentación de los Certificados RUE original y de Servicios Educativos, en caso de extravío los informes correspondientes.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 68: //cierre definitivo
                    if ($('#form_i_certificadorue_cierre').is(':checked') == false) {
                        alert('Seleccione la presentación de los Certificados RUE original y de Servicios Educativos, en caso de extravío los informes correspondientes.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>Datos verificados con éxito.</div>');
                    }
                    break;
                case 44: //Reapertura
                    break;
                case 45: //nuevo certifcado rue
                    if ($('#form_i_solicitud_nuevorue').val() == '') {
                        alert('Debe adjuntar el Adjuntar Informe Técnico circunstanciado de extravío del Original del Certificado RUE.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><i class="glyphicon glyphicon-ok"></i>Requisitos validados con éxito.</div>');
                    }
                    break;
                case 55: //Regularización RUE
                case 46: //Regularización RUE
                case 54: //apertura
                    if ($('#form_i_solicitud_apertura').val() == '') {
                        alert('Debe adjuntar la solicitud de apertura.');
                        return false;
                    }
                    if (dependenciaId == 1) {
                        if ($('#form_i_solicitud_apertura').val() == '') {
                            alert('Debe adjuntar la solicitud de apertura.');
                            return false;
                        } else if ($('#form_i_folio_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Copia legalizada del Testimonio o Folio Real emitido po Derechos Reales a nombre del Gobierno Autónomo Municipal correspondiente.');
                            return false;
                        } else if ($('#form_i_certificacion_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Certificación  emitida por el Gobierno Autónomo Municipal correspondiente, estableciendo si la unidad educativa cuya apertura y funcionamiento es del área rural o urbana, señalando la dirección exacta de la infraestructura.');
                            return false;
                        } else if ($('.areaApertura').is(':checked') == false) {
                            alert('Seleccione el área geográfica.');
                            return false;
                        } else if ($('#form_i_compromiso_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación del Compromiso Municipal de dotación y mantenimiento de infraestructura y equipamiento para la unidad educativa a crearse (en caso de unidades educativas fiscales y de convenio).');
                            return false;
                        }
                    }
                    if (dependenciaId == 2) {
                        if ($('#form_i_representante_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Copia legalizada del Testimonio de Poder del representante legal.');
                            return false;
                        } else if ($('#form_i_actafundacion_apertura').val() == '') {
                            alert('Debe adjuntar la Copia legalizada del Acta de Fundación');
                            return false;
                        } else if ($('#form_i_folio_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Copia legalizada del Testimonio o Folio Real emitido po Derechos Reales a nombre de la entidad prestadora de servicio.');
                            return false;
                        } else if ($('#form_i_convenio_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación del Convenio vigente de prestación de servicios educativos firmado entre la Institución Prestadora de Servicios y el Ministerio de Educación (ME) o el Director Departamental de Educación, según corresponda.');
                            return false;
                        } else if ($('#form_i_certificacion_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Certificación  emitida por el Gobierno Autónomo Municipal correspondiente, estableciendo si la unidad educativa cuya apertura y funcionamiento es del área rural o urbana, señalando la dirección exacta de la infraestructura.');
                            return false;
                        } else if ($('.areaApertura').is(':checked') == false) {
                            alert('Seleccione el área geográfica.');
                            return false;
                        } else if ($('#form_i_constitucion_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación de la Copia notaria actualizada del Acta de Constitución y estatutos de la Institución prestadora de servicios.');
                            return false;
                        } else if ($('#form_i_form_fundaempresa_apertura').is(':checked') == true && $('#form_nro_fundaempresa_apertura').val() == '') {
                            alert('Ingrese el Nro. de Matrícula de Comercio.');
                            return false;
                        } else if ($('#form_i_form_fundaempresa_apertura').is(':checked') == true && $('#form_fecha_fundaempresa_apertura').val() == '') {
                            alert('Ingrese la fecha de inscripción de la Matrícula de Comercio.');
                            return false;
                        } else if ($('#form_i_fotocopia_nit_apertura').is(':checked') == true && $('#form_nit_apertura').val() == '') {
                            alert('Ingrese el Nro. de N.I.T..');
                            return false;
                        } else if ($('#form_i_fotocopia_nit_apertura').is(':checked') == true && $('#form_i_balance_apertura').is(':checked') == false) {
                            alert('Seleccione la presentación del Balance de apertura de la unidad educativa, sellado por el Servicio de Impuestos Nacionales SIN (si corresponde).');
                            return false;
                        } else if ($('#form_i_testimonioconvenio').val() == '') {
                            alert('Ingrese el Nro. del Testimonio de personeria jurídica emitido por la entidad correspondiente');
                            return false;
                        }
                    }
                    if (dependenciaId == 3 && $('.alquilerApertura').is(':checked') == false) {
                        alert('Seleccione si la infraestructura es arrendada o no.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_ii_alquiler_apertura_0').is(':checked') == true && $('#form_ii_contrato_apertura').val() == '') {
                        alert('Debe adjuntar la Copia notariada de compromiso de contrato por un plazo no menor a seis años');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_ii_alquiler_apertura_1').is(':checked') == true && $('#form_ii_folio_apertura').is(':checked') == false) {
                        alert('Seleccione la presentación de la Copia legalizada del Testimonio o Folio Real emitido po Derechos Reales estableciendo que la infraestructura esta destinada a la unidad educativa y pertenece a los propietarios de la misma.');
                        return false;
                    } else if ($('#form_ii_inventario_apertura').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación del Inventario de mobiliario y equipamento de la Unidad Educativa de acuerdo a norma.');
                        return false;
                    } else if ($('#form_ii_planos_apertura').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación de la Copia legalizada de los Planos arquitectónicos (especificando los ambientes), aprobados por el Gobierno Autónomo Municipal correspondiente, para infraestructura de ambientes propios, que contemplen la adecuación progresiva para la atención de la población con discapacidad leve, en el caso de área dispersa, el cumplimiento de este requisito se incluirá en el informe del Director Distrital de Educación correspondiente.');
                        return false;
                    } else if ($('#form_ii_planos_apertura').is(':checked') == false) {
                        alert('En el punto 2.Requisitos de Infraestructura, seleccione la presentación de la Copia legalizada de los Planos arquitectónicos (especificando los ambientes), aprobados por el Gobierno Autónomo Municipal correspondiente, para infraestructura de ambientes propios, que contemplen la adecuación progresiva para la atención de la población con discapacidad leve, en el caso de área dispersa, el cumplimiento de este requisito se incluirá en el informe del Director Distrital de Educación correspondiente.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_reglamento_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Reglamento interno de funcionamiento de disposiciones administrativas.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_convivencia_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Reglamento de convivencia armónica y pacífica que contenga los mecanismos preventivos, medidas reparadoras de solución de conflictos, tipificación de infracciones, procedimientos y sanciones.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_manual_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Manual de organización y funciones (misión, objetivos, estructura organizativa, objetivos de áreas, descripción y objetivos de funciones, superviciones y coordinación).');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_kardex_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Kardex de maestras y maestros y personal administrativo.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_sippase_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Cetificado SIPPASE y REJAP del plantel docente y administrativo (en mérito al D.S. Nro. 1302 y 1320).');
                        return false;
                    } else if ($('#form_iii_poa_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación del Plan Operativo Anual (POA) de la gestión en la que iniarán actividades, firmado por la o el Director Distrital de Educación correspondiente.');
                        return false;
                    } else if (dependenciaId == 3 && $('#form_iii_contratos_apertura').is(':checked') == false) {
                        alert('En el punto 3. Requisitos Administrativos, seleccione la presentación de los Contratos firmados por el personal docente con pertinencia académica.');
                        return false;
                    } else {
                        $('#validar' + id).val(1);
                        $('#msg' + id).empty();
                        $('#msg' + id).append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><i class="glyphicon glyphicon-ok"></i>Requisitos validados con éxito.</div>');
                    }
                    break;
            }
        }

        function apertura(id) {
            var formData = {id: id, desglose: 1, ie: '{{ institucioneducativa.id }}'};
            if ($("#modal_apertura_datos").length) {
                return false;
            }
            //alert(id);
            $.ajax({
                type: 'GET',
                url: "{{ path('tramite_cea_apertura') }}",
                data: formData,
                beforeSend: function () {
                    $('#modal_apertura').empty();
                    $("#modal_apertura").append('<div style="text-align:center">Cargango datos...<img src="{{ asset('img/loading.gif') }}"  /></div>');
                },
                success: function (data) {
                    //console.log(data);
                    $('#modal_apertura').empty();
                    $('#modal_apertura').append(data);
                    $('.date').datepicker({
                        orientation: "auto left",
                        forceParse: false,
                        autoclose: true,
                        todayHighlight: true,
                        language: 'es'
                    });
                    $('[data-toggle="tooltip"]').tooltip();
                    var image = L.icon({
                        iconUrl: "{{ asset('images/marker23.png') }}",
                        iconSize: [40, 40]
                    });
                    initMap(image);
                },
            });
        }

        function aperturaSubcentro(id) {
            var formData = {id: id, desglose: 0, ie: '{{ institucioneducativa.id }}'};
            if ($("#modal_apertura_datos").length) {
                return false;
            }
            //alert(formData.ie);
            $.ajax({
                type: 'GET',
                url: "{{ path('tramite_cea_apertura_subcentro') }}",
                data: formData,
                beforeSend: function () {
                    $('#modal_apertura').empty();
                    $("#modal_apertura").append('<div style="text-align:center">Cargango datos...<img src="{{ asset('img/loading.gif') }}"  /></div>');
                },
                success: function (data) {
                    //console.log(data);
                    $('#modal_apertura').empty();
                    $('#modal_apertura').append(data);
                    $('.date').datepicker({
                        orientation: "auto left",
                        forceParse: false,
                        autoclose: true,
                        todayHighlight: true,
                        language: 'es'
                    });
                    $('[data-toggle="tooltip"]').tooltip();
                    var image = L.icon({
                        iconUrl: "{{ asset('images/marker23.png') }}",
                        iconSize: [40, 40]
                    });
                    initMap(image);
                },
            });
        }

        function actualizacion(id) {
            var formData = {id: id, ie: '{{ institucioneducativa.id }}'};
            if ($("#modal_apertura_datos").length) {
                return false;
            }
            $.ajax({
                type: 'GET',
                url: "{{ path('tramite_cea_actualizacion') }}",
                data: formData,
                beforeSend: function () {
                    $('#modal_actualizacion').empty();
                    $("#modal_actualizacion").append('<div style="text-align:center">Cargango datos...<img src="{{ asset('img/loading.gif') }}"  /></div>');
                },
                success: function (data) {
                    //console.log(data);
                    $('#modal_actualizacion').empty();
                    $('#modal_actualizacion').append(data);
                    $('.date').datepicker({
                        orientation: "auto left",
                        forceParse: false,
                        autoclose: true,
                        todayHighlight: true,
                        language: 'es'
                    });
                    $('[data-toggle="tooltip"]').tooltip();
                    var image = L.icon({
                        iconUrl: "{{ asset('images/marker23.png') }}",
                        iconSize: [40, 40]
                    });
                    initMap(image);
                },
            });
        }

        function verificarApertura() {
            if ($('#form_institucioneducativa').val() == '') {
                alert('En el punto DATOS GENERALES, debe ingresar el nombre de la nueva Unidad Educativa.');
                return false;
            } else if ($('#form_fechafundacion').val() == '') {
                alert('En el punto DATOS GENERALES, debe ingresar la fecha de fundación.');
                return false;
            } else if ($('#form_telefono').val() == '') {
                alert('En el punto DATOS GENERALES, debe ingresar el Telefono de Referencia.');
                return false;
            } else if ($('#form_director').val() == '') {
                alert('En el punto DATOS GENERALES, debe ingresar los Datos del Director/Encargado/Propietario.');
                return false;
            } else if ($('#form_departamento2001').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar el departamento de la Ubicación Geográfica(Censo 2001 - R.U.E.).');
                return false;
            } else if ($('#form_provincia2001').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar la provincia de la Ubicación Geográfica(Censo 2001 - R.U.E.).');
                return false;
            } else if ($('#form_municipio2001').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar el municipio de la Ubicación Geográfica(Censo 2001 - R.U.E.).');
                return false;
            } else if ($('#form_canton2001').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar el canton de la Ubicación Geográfica(Censo 2001 - R.U.E.).');
                return false;
            } else if ($('#form_localidad2001').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar la localidad de la Ubicación Geográfica(Censo 2001 - R.U.E.).');
                return false;
            } else if ($('#form_departamento2012').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar el departamento de la Ubicación Geográfica(Censo 2012 - información referencial).');
                return false;
            } else if ($('#form_provincia2012').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar la provincia de la Ubicación Geográfica(Censo 2012 - información referencial).');
                return false;
            } else if ($('#form_municipio2012').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar el municipio de la Ubicación Geográfica(Censo 2012 - información referencial).');
                return false;
            } else if ($('#form_comunidad2012').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe seleccionar la comunidad de la Ubicación Geográfica(Censo 2012 - información referencial).');
                return false;
            } else if ($('#form_zona').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe ingresar la zona.');
                return false;
            } else if ($('#form_direccion').val() == '') {
                alert('En el punto UBICACIÓN GEOGRÁFICA, debe ingresar la direccion.');
                return false;
            } else if ($('#form_dependencia').val() == '') {
                alert('En el punto DEPENDENCIA NIVEL, debe seleccionar la Dependencia.');
                return false;
            } else if ($('#form_dependencia').val() == 2 && $('#form_conveniotipo').val() == '') {
                alert('En el punto DEPENDENCIA NIVEL, debe seleccionar el tipo de convenio.');
                return false;
            } else if ($('.nivel').is(':checked') == false) {
                alert('En el punto DEPENDENCIA NIVEL, debe seleccionar el o los niveles de organización curricular.');
                return false;
            } else if ($('.nivel').is(':checked') == true) {
                $('.nivel').each(function () {
                    if ($(this).is(':checked')) {
                        if ($(this).val() == 11 && ($('#form_cantidad_11_1').val() == '' || $('#form_cantidad_11_2').val() == '')) {
                            alert('En el punto CANTIDAD DE ESTUDIANTES POR GRADO, debe ingresar las cantidades de estudiantes para Educación Inicial en Familia Comunitaria.');
                            return false;
                        }
                        if ($(this).val() == 12 && ($('#form_cantidad_12_1').val() == '' || $('#form_cantidad_12_2').val() == '' || $('#form_cantidad_12_3').val() == '')) {
                            alert('En el punto CANTIDAD DE ESTUDIANTES POR GRADO, debe ingresar las cantidades de estudiantes para Educación Primaria Comunitaria Vocacional.');
                            return false;
                        }
                        if ($(this).val() == 13 && ($('#form_cantidad_13_1').val() == '' || $('#form_cantidad_13_2').val() == '' || $('#form_cantidad_13_3').val() == '')) {
                            alert('En el punto CANTIDAD DE ESTUDIANTES POR GRADO, debe ingresar las cantidades de estudiantes para Educación Secundaria Comunitaria Productiva.');
                            return false;
                        }
                    }
                });
            }
            if ($('#form_cantidad_adm').val() == '') {
                alert('En el punto CANTIDAD DE PERSONAL, debe ingresar la cantidad de personal administrativo.');
                return false;
            } else if ($('#form_cantidad_maestro').val() == '') {
                alert('En el punto CANTIDAD DE PERSONAL, debe ingresar la cantidad de Docente (Maestros).');
                return false;
            } else {
                $('#validarApertura').val(1);
                $('#msgApertura').empty();
                $('#msgApertura').append('<div class="alert alert-success"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><i class="glyphicon glyphicon-ok"></i>Datos de apertura validados con éxito.</div>');
            }
        }

        $('.btn-lilac').click(function () {
            $(this).removeClass("btn-lilac");
            $(this).addClass("btn-teal");

        });

        function borrarFila(id) {
            var array = JSON.parse($('#form_tr').val());
            if ((id == 34 || id == 43) && $('#form_tr').val() != "" && JSON.parse($('#form_tr').val()).includes(39) == true) {
                for (var i = array.length - 1; i >= 0; i--) {
                    if (array[i] == 34 || array[i] == 43 || array[i] == 39) {
                        $('#fila_' + array[i]).remove();
                        $('#modal_' + array[i]).remove();
                        array.splice(i, 1);
                    }
                }
            } else if ((id == 35 || id == 63) && $('#form_tr').val() != "" && JSON.parse($('#form_tr').val()).includes(40) == true) {
                for (var i = array.length - 1; i >= 0; i--) {
                    if (array[i] == 35 || array[i] == 63 || array[i] == 40) {
                        $('#fila_' + array[i]).remove();
                        $('#modal_' + array[i]).remove();
                        $('#modal_apertura').remove();
                        array.splice(i, 1);
                    }
                }
            } else {
                $('#fila_' + id).remove();
                $('#modal_' + id).remove();
                var index = array.indexOf(id);
                array.splice(index, 1);
            }
            if (array.length == 0) {
                $('#form_tr').val('');
            } else {
                $('#form_tr').val(JSON.stringify(array));
            }
        }

        function validacion() {
            //alert($('#tabla tr').length);
            var filas = $('#tabla tr').length - 1;
            if (filas == 0) {
                alert('Seleccione datos a modificar.');
                return false;
            } else if (JSON.parse($('#form_tr').val()).includes(39) == true && $('#form_siefusion').val().length < 8) {
                alert('Ingrese codigo SIE a Cerrar Definitivamente válido.');
                return false;
            }
            if (JSON.parse($('#form_tr').val()).includes(34) == true) {
                var ok = 0;
                $('.niveltipo').each(function () {
                    if ($(this).is(':checked')) {
                        ok = ok + 1;
                    }
                });
                if (ok == 0) {
                    alert('Seleccione el o los niveles a ampliar.');
                    return false;
                }
            }
            if (JSON.parse($('#form_tr').val()).includes(35) == true) {
                var ok = 0;
                $('.niveltipo').each(function () {
                    if (!$(this).is(':checked')) {
                        ok = ok + 1;
                    }
                });
                if (ok == 0) {
                    alert('Deseleccione el o los niveles a reducir.');
                    return false;
                }
            }
            if (JSON.parse($('#form_tr').val()).length > 0) {
                var arr = [];
                $.each(JSON.parse($('#form_tr').val()), function (index, value) {
                    if ($('#modal_requisitos_' + value).length == 0 && value != 39 && value != 40) {
                        var texto = $('#fila_' + value + ' td').html().replace('<strong>', '');
                        texto = texto.replace('</strong>', '');
                        arr.push(texto);
                        //arr.push($('#fila_'+value+' td').html());
                    }
                });
                //console.log(arr);
                if (arr.length > 0) {
                    alert('Registre los requisitos de el/los trámite/s: ' + arr.toString());
                    return false;
                }
            }

            if (JSON.parse($('#form_tr').val()).includes(54) == true) {
                if ($('#validarApertura').val() == 0) {
                    alert('Debe validar los datos de la nueva Unidad Educativa');
                    return false;
                }
            }

            if (JSON.parse($('#form_tr').val()).length > 0) {
                var arr = [];
                $.each(JSON.parse($('#form_tr').val()), function (index, value) {
                    if ($('#validar' + value).val() == 0) {
                        var texto = $('#fila_' + value + ' td').html().replace('<strong>', '');
                        texto = texto.replace('</strong>', '');
                        arr.push(texto);
                        //arr.push($('#fila_'+value+' td').html());
                    }
                });
                //console.log(arr);
                if (arr.length > 0) {
                    alert('Debe validar los requisitos de el/los trámite/s: ' + arr, toString());
                    return false;
                }
            }

            if ($('.btn-lilac').length > 0) {
                alert('Debe abrir y verificar todos los archivos adjuntos de los formularios anteriores.');
                return false;
            } else {
                $('#form_guardar').prop('disabled', true);
                return true;
            }
        }
    </script>
{% endblock %}