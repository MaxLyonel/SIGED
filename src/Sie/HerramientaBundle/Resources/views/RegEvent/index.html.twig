{% extends 'layoutHerramienta.html.twig' %}
{% block contentoption %}
    <div class="header-content">
        <h2><i class="fa fa-list-alt"></i> Registro de Evento <span> Busqueda</span></h2>
        <div class="breadcrumb-wrapper hidden-xs">
            <span class="label">Usted esta aquí:</span>
            <ol class="breadcrumb">
                <li>
                    <i class="fa fa-home"></i>
                    <a href="#">Registro de Eventos</a>
                    <i class="fa fa-angle-right"></i>
                </li>
            </ol>
        </div><!-- /.breadcrumb-wrapper -->
    </div>
    <div class="body-content animated fadeIn">
        <div class="row">
            <div class="col-lg-12">
                <div class="panel rounded shadow panel-teal">
                    <div class="panel-heading">
                        <div class="pull-left">
                            <h3 class="panel-title">Lista de Eventos</h3>
                        </div>
                            <div class="pull-right">
                                <button class="btn btn-warning btn-sm" data-toggle="modal" data-target=".bs-example-modal-lg"><i class="fa fa-plus"></i> Nuevo Evento</button>
                                {#<a href="{{path('herramientalt_info_maestro_find')}}" class="btn btn-warning btn-sm"><i class="fa fa-plus"></i> Nuevo Evento</a>#}
                            </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="panel-body">
                        <div class="panel-body panel-primary">
                            {% if listaeventos is not empty %}
                                <div id="no-more-tables">
                                    <table class="table table-striped table-primary">
                                        <thead>
                                        <tr>
                                            <th>No.</th>
                                            <th>Nombre de Evento</th>
                                            <th>Dia Inicio</th>
                                            <th>Dia Fin</th>
                                            <th>Opciones</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for listaeventos in listaeventos %}
                                            <tr>
                                                <td data-title="N°">{{ loop.index }}</td>
                                                <td data-title="evento">{{ listaeventos.nombre_evento }}</td>
                                                <td data-title="fechainicio">{{ listaeventos.fecha_inicio|date('d-m-Y') }}</td>
                                                <td data-title="fechafin">{{ listaeventos.fecha_fin|date('d-m-Y') }}</td>
                                                    <td data-title="Acciones">
                                                        <form action="{{path('herramientalt_info_maestro_delete')}}" method="post" style="display: inline-block">
                                                            <input type="hidden" name="idEvento" value="{{listaeventos.id}}">
                                                            <input type="hidden" name="idInstitucion" value="{{id_Intitucion}}">
                                                            <input type="hidden" name="gestion" value="{{id_gestion}}">
                                                            <button type="submit" class="btn-link" onclick="return confirm('Se eliminara el evento!. ¿Desea continuar?');"><i class="fa fa-trash-o text-danger"></i> Eliminar</button>
                                                        </form>
                                                        <form action="{{path('herramientalt_info_maestro_edit')}}" method="post" style="display:inline-block">
                                                            <input type="hidden" name="idEvento" value="{{listaeventos.id}}">
                                                            <input type="hidden" name="idInstitucion" value="{{id_Intitucion}}">
                                                            <input type="hidden" name="gestion" value="{{id_gestion}}">
                                                            <button type="submit" class="btn-link"><i class="fa fa-eye text-warning"></i> Ver Resultado</button>
                                                        </form>
                                                    </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                No hay Eventos registrados
                            {% endif %}

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade bs-example-modal-lg in" tabindex="-1" role="dialog" aria-hidden="true" >
        <div class="modal-dialog modal-md modal-primary">
            <div class="modal-content">
                <form id="form_eventos">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title"><i class="fa fa-check"></i> Nuevo Evento</h4>
                </div>
                <div class="modal-body">

                        <div class="form-group">
                            <label for="nombreevento">Nombre del Evento</label>

                                <input type="text" class="form-control" name="nombreevento" placeholder="Nombre de Evento" required>

                        </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="diainicio" >Día Inicio</label>
                                <input type="date" class="form-control" name="diainicio" placeholder="Dia Inicio" required>

                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="diafin" >Día Fin</label>

                                <input type="date" class="form-control" name="diafin" placeholder="Dia Fin" required>

                            </div>

                        </div>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                    <button type="submit" class="btn btn-theme" onclick="guardarEvento()" >Registrar</button>
                </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
{% block javascripts%}
    {{ parent() }}
    <script>
        function  guardarEvento() {
            swal({
                title: "¿Está Segura/o de registrar el evento?",
                icon: "warning",
                buttons: true,
                dangerMode: true,
                buttons: ["Cancelar", "Continuar"],
            })
                .then(function(willDelete)  {
                    if (willDelete) {

                        $.ajax({
                            type: 'post',
                            url: "{{ path('regevent_event_register') }}",
                            data: formdata,
                            mimeType:"multipart/form-data",
                            contentType: false,
                            cache: false,
                            processData:false,
                            beforeSend: function () {
                                swal({
                                    title: "Guardando Evento...",
                                    text: "Espere un momento por favor",
                                    icon: imagen,
                                    buttons: false
                                });
                            },
                            success: function (data) {

                                /*if (data==1){
                                    swal("Su respuesta se ha enviado con éxito, con Nro. de Trámite: "+ { { id_tramite }});
                                    location.href = "{ { path('wf_tramite_recibido') }}";
                                }
                                else{
                                    swal("Su formulario no se envío correctamente");
                                }*/
                            },
                            complete: function () {
                                swal.stopLoading();
                                swal.close();
                            }
                        });
                    }
                });

        }
    </script>
{% endblock %}
