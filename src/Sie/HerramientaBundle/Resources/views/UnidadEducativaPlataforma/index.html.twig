{% extends 'layoutHerramienta.html.twig' %}
{% block stylesheets %}
    {{parent()}}
    <style>

        [v-cloak]{
            display: none;
        }
        .readData{
            background-color: lightblue;
            color:  #000;
            opacity: 0.8;
         

        }
    </style>

{% endblock %}
{% block contentoption %}


    <!-- Start page header -->
    <div class="header-content">
        <h2><i class="fa fa-table"></i> Solicitud Plataforma dddd<span></span></h2>
        <div class="breadcrumb-wrapper hidden-xs">
            <span class="label">Usted esta aquí:</span>
            <ol class="breadcrumb">
                <li>
                    <i class="fa fa-home"></i>
                    <a href="#">Solicitud Plataforma</a>
                    <i class="fa fa-angle-right"></i>
                </li>
                <li class="active"></li>
            </ol>
        </div><!-- /.breadcrumb-wrapper -->
    </div><!-- /.header-content -->
    <!--/ End page header -->

    <!-- /.row -->
<div id="app" v-cloak>
    <div class="modal fade" id="modalEstudianteTwo" data-backdrop="static">
        <div class="modal-dialog" style="width:800px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Modificar Nivel y Grado</h4>
                </div>
                <div class="modal-body">

                  <div style="text-align:right;" v-if="swUpdateLevelGradoIniPri">
                    <button @click="isShowing ^= true" class="btn btn-xs btn-info" >Habilitar Inicial(1,2)/Primaria(1)</button>
                  </div>

                 
             

                </div>
            </div>
        </div>
    </div> 

      <div class="body-content animated fadeIn">
            <div class="row">
              <div class="col-xs-12 col-lg-12">


                <div class="panel panel-default">
                  <div class="panel-body">

					<table class="table table ">
	                    <tr>
	                      <tH>SIE</tH>
	                      <th>INSTITUCION EDUCATIVA</th>
	                    </tr>
	                    <tr  class="readData">
	                      <td>{{DataInstitucioneducativa.id}}</td>
	                      <td>{{DataInstitucioneducativa.institucioneducativa}}</td>
	                    </tr>
	                    <tr><td><button type="button" class="btn btn-primary">Actualizar</button></td></tr>
	                </table>


                    <form >
               
                      <div class="form-row">
                        <div class="form-group col-md-6">
                          <input type="text" v-model="student.codigoRude" class="form-control jupper" maxlength="17" v-on:keypress="alfanumerico" placeholder="COD. RUDE">
                        </div>
                      </div>
                      
                      <button type="button" class="btn btn-primary" @click="lookforStudentData()">Buscar</button>
                    </form>

                  </div>
                </div>

                            
              </div>
            </div>

            <div class="row">
                <div class="col-xs-12 col-lg-12">
                    <div v-if="buscando" class="text-center">
                        <img src="{{asset('img/loading.gif')}}" alt=""> Buscando...
                    </div>
                  <!--   <div v-if="!swresponse">
                                        <strong>${message}</strong>
                                    </div>   -->                  
                </div>
            </div>


            <div class="row" v-if="existStudentData">
                <div class="col-xs-12 col-lg-12">
                  <div class="panel panel-default">
                    <div class="panel-body">
                      
                      <table class="table table-dark">
                        <thead>
                          <tr>
                            <th scope="col">COD. RUDE</th>
                            <th scope="col">PATERNO</th>
                            <th scope="col">MATERNO</th>
                            <th scope="col">NOMBRE(S)</th>
                            <th scope="col">FECHA NACIMIENTO</th>
                            <th scope="col">CI COMPLEMENTO</th>  
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>${objStudent.rude}</td>
                            <td>${objStudent.paterno}</td>
                            <td>${objStudent.materno}</td>
                            <td>${objStudent.nombre}</td>
                            <td>${objStudent.fecNac}</td>
                            <td>${objStudent.carnet} ${objStudent.complemento}</td>
                          </tr>
                          
                        </tbody>
                      </table>

                    <small>
                    <table class="table table" aria-describedby="example-table_info" style="margin-top:50px;">
                          <thead>
                            <tr>
                            <td>Gestión</td>
                            <td>SIE</td>
                            <td>Unidad Educativa</td>
                            <td>Nivel</td>
                            <td>Grado</td>
                            <td>Paralelo</td>
                            <td>Turno</td>
                            <td>Estado Matrícula</td>
                            </tr>
                            
                          </thead>

                          
                        <tbody role="alert" aria-live="polite" aria-relevant="all"><tr class="success odd">
                                <tr v-for="studentHistory in DBhistory">
                                  <td class=" ">${studentHistory.gestion}</td>
                                  <td class=" ">${studentHistory.sie}</td>
                                  <td class=" ">${studentHistory.institucioneducativa}</td>
                                  <td class=" ">${studentHistory.nivel}</td>
                                  <td class=" ">${studentHistory.grado}</td>
                                  <td class=" ">${studentHistory.paralelo}</td>
                                  <td class=" ">${studentHistory.turno}</td>
                                  <td class=" ">${studentHistory.estadoMatricula}</td>
                                </tr>
                                
                        </tbody>
                    </table> 
                    </small>

                    <div v-if="swObservation">
                       <!-- v-on:click="showhistory(oldStudent.rude)" -->
                        <a class="btn btn-warning" data-toggle="modal" href='#modalEstudianteTwo' > <i class="fa fa-eye"></i> ${ messageObservaation } </a>
                    </div>
                    <div v-else >
                      <div class="alert alert-success" role="alert">${ messageObservaation } </div>                     

                          <div class="col-sm" v-if='swUpdateLevelGradoIniPri' style=" text-align: right; ">
                            <a class="btn btn-info" data-toggle="modal" href='#modalEstudianteTwo' @click="clearIniPriVars"> <i class="fa fa-eye"></i>Modificar Inicial(1,2)/Primaria(1) </a>
                          </div>
                    
                    </div>
                  </div>                    
                </div>
            </div>



      </div>
  </div>



{% endblock %}
{% block javascripts%}
    {{parent()}}
    <script type="text/javascript">
    // $("#form_idfecnac").inputmask({ "alias": "dd-mm-yyyy", 'placeholder':'dd-mm-aaaa' });
  </script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.15.2/axios.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>   
      <script src="{{asset('js/inputmask.js')}}"></script>
    <script type="text/javascript">
// $("#form_idfecnac").inputmask({ "alias": "dd-mm-yyyy", 'placeholder':'dd-mm-aaaa' });
    


        var app = new Vue({
            delimiters: ['${', '}'],
            el: '#app',

            data: {
              
              DBTurno:{},
              DBLevel:{},
              DBGrado:{},
              objErrors:[],
              DBhistory:{},
              objStudent:{},
              DBParalelos:{},
              currenteInscription:{},
              messageObservaation:'',
              student:{codigoRude:''},
              buscando:false,
              isShowing:false,
              swObservation:false,
              existStudentData:false,
              swUpdateLevelGradoIniPri:false,
              DBNextLevel:{'paraleloId':'','turnoId':''}
              
              
 
            },
            methods: {

              lookforStudentData: function(){
                this.buscando=true;
                this.existStudentData=false;
                this.swObservation=false;
                this.messageObservaation='';
                this.currenteInscription={};
                this.DBParalelos={};
                this.DBNextLevel={};
                this.DBLevel={};
                this.DBGrado={};
                axios.post(Routing.generate('updateSudentLevel_look_student_data', this.student))
                .then(response => {
                  
                  if (response.status == 200) {
                    this.DBParalelos = response.data.arrParalelos;
                    this.DBNextLevel = response.data.arrNextLevel;
                    this.DBhistory = response.data.dataInscriptionR;
                    this.objStudent = response.data.arrStudentExist;
                    this.swObservation = response.data.swObservation;
                    this.existStudentData = response.data.existStudentData;
                    this.messageObservaation = response.data.messageObservaation;
                    this.currenteInscription = response.data.arrCurrenteInscription;
                    this.swUpdateLevelGradoIniPri = response.data.swUpdateLevelGradoIniPri;
                    this.DBLevel = response.data.arrLevel;

                  }
                 this.buscando=false;
                })
                .catch(e => {
                  Swal.fire(
                      'Aviso',
                      'No se pudo realizar la Busqueda',
                      'error'
                  )
                  
                });                
        
              },
         
              alfanumerico: function(event){
                  var k = event.charCode || event.keyCode;
                  if ((k < 97 || k > 122)//letras minusculas
                      && (k < 65 || k > 90) //letras mayusculas
                      && (k < 48 || k > 57) //NUmeros
                      && (k != 13) //ENTER
                      && (k != 8) //retroceso
                      && (k != 9) //tab
                      && (k != 241) //ñ
                       && (k != 209) //Ñ
                       && (k != 32) //espacio
                       && (k != 225) //á
                       && (k != 233) //é
                       && (k != 237) //í
                       && (k != 243) //ó
                       && (k != 250) //ú
                       && (k != 193) //Á
                       && (k != 201) //É
                       && (k != 205) //Í
                       && (k != 211) //Ó
                       && (k != 218) //Ú
                       && (k != 44) //coma ,
                       && (k != 46) //punto .
                  ){
                    event.preventDefault();
                    return false;
                  }
              },              

           

            },
            mounted(){
               
            }
        });

        $(document).ready(function(){
            $('[data-toggle="tooltip"]').tooltip();
            $("td").focus();
        });        


    </script>
{%endblock%}
