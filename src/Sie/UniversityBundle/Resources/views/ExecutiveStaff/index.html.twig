{% extends app.session.get('layout') %}
{% block contentoption %}
    
    <style type="text/css">
        [v-cloak]{
            display: none;
        }
        .buscador{
            margin-top: -20px;
            /* background: #E4E4E4; */
            padding: 10px;
        }
        .encabezado{
            padding: 5px;
            /* font-weight: bold; */
        }
        .estudiante{
            padding: 10px;
            background: #EEEEEE;
            text-align: center;
            font-weight: bold;
            font-size: 17px;
        }
        .jupper{
            text-transform: uppercase;
        }
        input[type='text']{
            /* background: #000000; */
            text-transform: uppercase;
            color: #000000 !important;
        }
        .select-nota:hover{
            /* border-color: #60AA5D; */
            background: #EAFBF1;
            color: #009900;
        }
        .seleccionado{
            background: #B8F1CA !important;
        }
        .headtabla{
            background: #717171 !important;
            color: #FFFFFF;
            border-bottom: none !important;
        }
        .check{
            /* background: #EEEEEE; */
            /* margin-right: 30px; */
        }
        h5{
            font-weight: bold;
        }
        .cajaPromedio{
            font-weight: bold; 
            /* background:#DDDDDD; */
            background:#EAEAEA !important;
        }
        .cajaNota{
            cursor: pointer;
        }

        .include{
            margin: 20px;
        }
        .titulo{
            padding: 5px;
        }
        .tachado{
            text-decoration: line-through;
            /* color: #D5956E; */
            /* color:  #D51528; */
            color:  #555555;
            opacity: 0.4;
            /* display: none; */
        }
        /* nota seleccionada */
        .notaNueva{
            /* color: #1EB480; */
            /* color: #7B7DA7; */
            font-size: 1.2em;
        }
        .notaNuevaAprobado{
            /* color: #1EB480; */
            color: #5CA813;
            font-size: 1.2em;
        }
        .notaNuevaReprobado{
            /* color: #1EB480; */
            color: #E62220;
            font-size: 1.2em;
        }
        input[type=”file”]#image {
            width: 0.1px;
            height: 0.1px;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            z-index: -1;
        }
        label[for="image"] {
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            background-color: #14A1DA;
            display: inline-block;
            transition: all .5s;
            cursor: pointer;
            padding: 5px 20px !important;
            width: fit-content;
            text-align: center;
        }
        .vistaModificaciones{
            float: right;
            font-size: 1.2em;
        }
        textarea{
            resize: vertical;
        }
    </style>
    <style type="text/css">
        .requisitos{
            background: #EEEEEE;
            padding: 5px;
            padding-left: 50px;
            box-shadow: 4px 4px #DDDDDD;
            margin-bottom: 15px;
        }
        .requisitos > .checkbox > label{
            color: #2A3271;
            font-size: 1.2rem !important;
        }
    </style>
    <style type="text/css">
		.row > div{
		  /*background: #f2f2f2;*/
		  padding: 2px;
		  border: 0px solid grey;
		}    	
    </style>

    <div class="header-content">
        <h2 name="tramiteEnviado"><i class="fa fa-list-alt"></i> Universidad <span></span></h2>
        <div class="breadcrumb-wrapper hidden-xs">
            <span class="label">Usted esta aquí:</span>
            <ol class="breadcrumb">
                <li>
                    <i class="fa fa-home"></i>
                    <a href="#">Universidad</a>
                    <i class="fa fa-angle-right"></i>
                </li>
                <li class="active">Personal Ejecutivo</li>
            </ol>
        </div><!-- /.breadcrumb-wrapper -->
    </div><!-- /.header-content -->
    <div class="include animated fadeIn">

    </div>
    <div id="app">
    <div v-cloak>
        <div class="body-content animated fadeIn">


			{# star tthis is the new #}


			 <div class="row">
		    	<div class="col-sm-2">
					<table class="table">
					  <thead class="thead-dark">
					    <tr>
					      <th scope="col">#</th>
					      <th scope="col">Gestion</th>
					    </tr>
					  </thead>
					  <tbody>
					    <tr>
					      <th scope="row">1</th>
					      <td>  <a href='#' v-on:click="getInfoStaff(2022)">2022</a></td>
					    </tr>						  
					  </tbody>
					</table>				    	
		    	</div>
		    	<div class="col-sm-10">
		            <div class="panel panel-primary" v-if="swgetinfostaff">
		                <div class="panel-heading yearOld">
		                    <h3 class="panel-title"> <i class="fa fa-file"></i> Personal Ejecutivo ${yearSelected}</h3>
		                </div>
		                <div class="panel-body">
		                    <div class="row">
		                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
		                            <div class="text-center">
		                                <h3>PERSONAL EJECUTIVO ${yearSelected}</h3>
		                                <p>Universidades</p>
		                            </div>
		                            <a class="btn btn-primary yearOld" data-toggle="modal" href='#modalEstudiante' style="float:right; margin-top:-12px;" > <i class="fa fa-search"></i> Nuevo Personal </a>
		                            <div class="clearfix"></div>
		                        </div>

		                    </div>
		                </div>
		            </div>
		    	</div>
			 </div>


			{# end this is the new #}



        </div>

        <div class="modal fade" id="modalEstudiante">
            <div class="modal-dialog" style="width:800px">
                <div class="modal-content">
                    <div class="modal-header yearOld">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title"> <i class="fa fa-search"></i> Buscar Personal</h4>
                    </div>
                    <div class="modal-body">
                        <form name="form" method="post" data-toggle="validator" role="form" id="idSearchStudentForm" class="form-inline">
                                <div class="form-body">
                                  <div class="row">
                                      <div class="col-md-10 col-md-offset-1">
                                        <input type="text" v-model="DBsearch.cibuscar" id="form_ci" name="form[ci]" required="required" class="form-control" placeholder="Carnet Identidad" pattern="[A-Za-z0-9\sñÑ]{3,18}" maxlength="9" autocomplete="off" style="text-transform:uppercase">
                                        <input type="text" v-model="DBsearch.complementoval" id="form_complemento" name="form[complemento]" required="required" class="form-control" placeholder="Complemento" pattern="[A-Za-z0-9\sñÑ]{3,18}" maxlength="2" autocomplete="off" style="text-transform:uppercase">
                                        
                                        <button v-on:click="lookforperson()" type="button" class="btn btn-primary"><i class="fa fa-search"></i> Buscar </button>
                                        <button type="button" class="btn btn-danger mr-5" data-dismiss="modal">Cancelar</button>
                                      </div>
                                  </div>
                                </div><!-- /.form-body -->

                            
                        </form>                        

                        <div class="alert alert-warning" v-if="respuesta != ''"> <i class="fa fa-warning"></i> ${respuesta}</div>
                        <div v-if="buscando" class="text-center">
                            <img src="{{asset('img/loading.gif')}}" alt=""> Buscando...
                        </div>

                        <div v-if="answer">
			              <div v-if="answer">
			                <div class="panel panel-warning">
			                    <div class="panel-heading">
			                        <div class="panel-title">
			                        </div>
			                    </div>
			                        <div class="panel-body">
			                          <h4>Datos de la Busqueda</h4>
			                        	<form role="form">
				                            <div class="row">
				                              <div class="col-sm-4">
				                              <label for="paterno">Paterno</label>
				                              <input type="input" class="form-control" placeholder="Paterno" v-model="dataPerson.paterno" maxlength="35" autocomplete="off" style="text-transform:uppercase" v-bind:readonly='swperson'>
				                              </div>
				                              <div class="col-sm-4">
				                              <label for="materno">Materno</label>
				                                  <input type="input" class="form-control" placeholder="Materno" v-model="dataPerson.materno" maxlength="35" autocomplete="off" style="text-transform:uppercase" v-bind:readonly='swperson'>
				                              </div>
				                              <div class="col-sm-4">
				                              <label for="Nombre(s)">Nombre(s)</label>
				                                  <input type="input" class="form-control" placeholder="Nombre(s)" v-model="dataPerson.nombre" maxlength="35" autocomplete="off" style="text-transform:uppercase" v-bind:readonly='swperson'>
				                              </div>
				                            </div>
				                            </br>  

				                            <div class="row">
				                              <div class="col-sm-3">
				                              <label for="ci">Carnet de Identidad</label>
				                              <input type="text" class="form-control" placeholder="Carnet Identidad" v-model="dataPerson.carnet" v-bind:readonly='swperson'>
				                              </div>
				                              <div class="col-sm-3">
				                              <label for="complemento(s)">Complemento</label>
				                                  <input type="text" class="form-control" placeholder="Complemento"  maxlength="2" autocomplete="off" style="text-transform:uppercase" v-model="dataPerson.complemento" v-bind:readonly='swperson'>
				                              </div>

				                              <div class="col-sm-3">
				                              <label for="fechanac">Fec. Nacimiento</label>
				                                  <input type="text" class="form-control" id="form_idfecnac" name="form[idfecnac]" placeholder="dd-mm-aaaa" v-model="dataPerson.fecNac" v-bind:readonly='swperson'>
				                              </div>
				                              <div class="col-sm-3" v-if='!swperson'>
				                              <label for="genero">G&eacute;nero</label>
				                                <select name="arrGenero" id="idarrGenero" v-model="dataPerson.generoId" class="custom-select form-control" v-model="dataPerson.genero">  
				                                  <option value="1">Masculino</option>
				                                  <option value="2">Femenino</option>
				                                </select>
				                              </div>
				                            </div>
				                            </br>
											<div class="row" v-if="!swperson">
												<div class="col-sm-3">
												      <label for="ext">Extranejero</label>
												      <select name="arrApode" id="idarrGenero" v-model="dataPerson.extranjero" class="custom-select form-control" v-model="dataPerson.foreign">  
												      <option value="0">No</option>
												      <option value="1">Si</option>
												      </select> 
												</div>                          
											</div> 

											<div v-if="!swperson">
												<div class="row">
												  <div class="col-sm-3">
												    <button v-on:click="registerPerson()" type="button" class="btn btn-warning"><i class="fa fa-book"></i>Registrar </button>
												  </div>
												</div> 
											</div>			                            
			                            
			                        	</form>
			                        </div>
			                </div> 
			              </div>                        

                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
    </div>

{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.15.2/axios.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
    <script>
        var app = new Vue({
            delimiters: ['${', '}'],
            el: '#app',
            data: {
                
                buscando: false,
                respuesta: '',
                
                
                inscripciones: [],
                datos: [],

                idInscripcion: '',
                flujoTipo: '',
                notas: [],
                filas: [],
                notasCualitativas: [],
                filasCualitativas: [],
                justificacion: '',
                informe: '',
                flujoTipo: '',
                formularioEnviado: false,
                urlreporte: '',
                respuestaIdTramite: '',
                
                actualEstadomatricula: '',
                nuevoEstadomatricula: '',
                estadosMatricula: [],
                promedioGeneral: '',
                nuevoPromedioGeneral: '',

                checkInforme: false,
                checkCuaderno: false,
                checkFormulario: false,

                DBsearch: [],
                dataPerson: [],
                swperson: false,
                answer: false,
                swgetinfostaff: false,
                yearSelected:0
            },
            methods: {
                cerrarModal: function(){
                    $('#modalCalificaciones').modal('hide');
                },
                inArray: function(needle, haystack) {
                    var length = haystack.length;
                    for(var i = 0; i < length; i++) {
                        if(haystack[i] == needle) return true;
                    }
                    return false;
                },
				getInfoStaff: function(inyear){
                	this.swgetinfostaff = true;
                	this.yearSelected = inyear;
                },
                lookforperson: function(){
                    this.buscando = true;
                    this.estudiante = '';
                    this.carnet = '';
                    this.complemento = '';
                    this.inscripciones = '';
                    this.respuesta = '';
                    this.datos = '';
                    
                    this.directorNombre = '';
                    this.directorCarnet = '';
                    this.directorComplemento = '';

                    this.idInscripcion = '';
                    this.sie = '';
                    this.institucioneducativa = '';
                    this.nivel = '';
                    this.grado = '';
                    this.paralelo = '';
                    this.turno = '';
                    this.gestion = '';
                    this.departamento = '';
                    this.distrito = '';

                    this.notas = [];
                    this.filas = [];
                    this.notasCualitativas = [];
                    this.filasCualitativas = [];
                    this.justificacion = '';
                    this.informe = '';

                    if (this.DBsearch.cibuscar.length == 0) {
                        this.respuesta = 'Debe ingresar un CI válido';
                        this.buscando = false;
                        return;
                    }

                    if (this.DBsearch.cibuscar.length < 6) {
                        this.respuesta = 'El CI ingresado no es válido';
                        this.buscando = false;
                        return;
                    }
                    if(typeof(this.DBsearch.complementoval)  === 'undefined'){
                    	this.DBsearch.complementoval = '';
                    }
                    axios.get(Routing.generate('staff_lookforperson', this.DBsearch))
                    .then(response => {
                        if (response.status == 200) {
                        	
                        	this.dataPerson = response.data.arrPerson;

                        	this.swperson   = response.data.swperson;
                        	this.answer   = response.data.answer;

                            $('[data-toggle="tooltip"]').tooltip();
                        }
                        if( response.status == 202){
                            this.respuesta = response.data;
                        }

                        this.buscando = false;
                    })
                    .catch(e => {
                        console.log(e);
                        this.buscando = false;
                    });
                },


            },
            mounted(){
            }
        });

        // $(document).ready(function(){
        //     $('[data-toggle="tooltip"]').tooltip();
        //     $('[data-toggle="popover"]').popover();
        //     // $("td").focus();
        //     console.log('adsfadsfsadf');
        // });

        $(".jnumbersletters").keypress(function (key) {
            var key = key || window.event;
            var k = key.charCode || key.keyCode;
            if ((k < 97 || k > 122)//letras minusculas
                && (k < 65 || k > 90) //letras mayusculas
                && (k < 48 || k > 57) //NUmeros
                // && (k != 13) //ENTER
                && (k != 8) //retroceso
                && (k != 9) //tab
                && (k != 241) //ñ
                 && (k != 209) //Ñ
                 && (k != 32) //espacio
                 && (k != 225) //á
                 && (k != 233) //é
                 && (k != 237) //í
                 && (k != 243) //ó
                 && (k != 250) //ú
                 && (k != 193) //Á
                 && (k != 201) //É
                 && (k != 205) //Í
                 && (k != 211) //Ó
                 && (k != 218) //Ú
                 && (k != 44) //coma ,
                 && (k != 46) //punto .
                )
                return false;
        });

    </script>
{% endblock %}