{% extends app.session.get('layout') %}
{% block stylesheets %}
    {{parent()}}
    <style>
        .higherWider {
            width:800px;
            margin-top:100px;
        }
    </style>

{% endblock %}
{% block contentoption %}

    <div class="row">
        <div class="col-lg-12">
            <div class="page-title">
                <h1>Control de Calidad
                    <small>Index</small>
                </h1>
                <ol class="breadcrumb">
                    <li><i class="fa fa-home"></i>  <a href="{{path('ccalidad_index')}}"> Menú principal</a></li>
                </ol>
            </div>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <div class="row">
        <div class="col-md-12">
            {% for flashMessage in app.session.flashbag.get('correcto') %}
                <div class="alert alert-success" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <i class="glyphicon glyphicon-ok"></i> {{ flashMessage }}
                </div>
            {% endfor %}
            {% for flashMessage in app.session.flashbag.get('incorrecto') %}
                <div class="alert alert-danger" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <i class="fa fa-warning"></i> {{ flashMessage }}
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- begin DASHBOARD CIRCLE TILES -->
    {% if existError %}
    <div class="row">
    <div class="col-lg-12">
      <div class="portlet portlet-blue">
          <div class="portlet-heading">
              <div class="portlet-title">
                  <h4></h4>
              </div>
              <div class="clearfix"></div>
          </div>

          <div class="portlet-body">
                  <div class="table-responsive">

                    <table style="width:100%" border="0">
                      <tr>
                          <td>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>RUDE</th>
                                        <th>PATERNO</th>
                                        <th>MATERNO</th>
                                        <th>NOMBRE</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{studentOne.codigo_rude}}</td>
                                        <td>{{studentOne.paterno}}</td>
                                        <td>{{studentOne.materno}}</td>
                                        <td>{{studentOne.nombre}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table class="table table-bordered">
                              <thead>
                                  <tr role="row">
                                    <th class="text-center">Gestion</th>
                                    <th class="text-center">SIE</th>
                                    <th class="text-center">Unidad Educativa</th>
                                    <th class="text-center">Nivel</th>
                                    <th class="text-center">Grado</th>
                                    <th class="text-center">Paralelo</th>
                                    <th class="text-center">Turno</th>
                                    <th class="text-center">Estado Matricula</th>
                                    <th class="text-center">Inscripcion</th>
                                    <th class="text-center">Opciones</th>
                                  </tr>
                              </thead>

                          <tbody role="alert" aria-live="polite" aria-relevant="all">

                                    <tr class = "success">
                                        <td data-title="Rude">{{studentOne.gestion_tipo_id}}</td>
                                        <td data-title="Rude">{{studentOne.institucioneducativa_titulo}}</td>
                                        <td data-title="Rude">{{studentOne.institucioneducativa}}</td>
                                        <td data-title="Nombre">{{ studentOne.nivel|e }} </td>
                                        <td data-title="Paterno">{{studentOne.grado|e}}</td>
                                        <td data-title="Materno">{{studentOne.paralelo|e}}</td>
                                        <td data-title="Turno">{{studentOne.turno}} </td>
                                        <td data-title="Est. Matricula" class="text-center">{{studentOne.em}}</td>
                                        <td data-title="Est. Matricula" class="text-center">{{studentOne.emi}}</td>
                                        <td data-title="VerNota" class="text-center">
                                             <a href="#" onclick="seeNotaNew('{{studentOne.eiid}}', '{{studentOne.eid}}', '{{studentOne.nivel_tipo_id}}', '{{studentOne.grado_tipo_id}}', '{{studentOne.pid}}', '{{studentOne.turno_tipo_id}}', '{{studentOne.gestion_tipo_id}}', '{{studentOne.institucioneducativa_id}}')" ><span class="glyphicon glyphicon-eye-open"></span> Ver Calificaciones</a>
                                        </td>
                                    </tr>

                                </tbody>
                              </table>
                          </td>
                          <td>
                            <div id="studentOneId" style="display:block">
                              <a href="#" onclick="deleteInscription('{{studentTwo.eiid}}', '{{studentOne.eiid}}',  '{{studentOne.eid}}', '{{studentOne.gestion_tipo_id}}', '{{studentOne.institucioneducativa_id}}', '{{studentOne.estadomatricula_tipo_id}}', '{{idDetalle}}' )" ><span class="glyphicon glyphicon-trash"></span> Eliminar Inscripción</a>
                            </div>
                          </td>
                      </tr>
                    </table>
                  </div>
              </div>
          </div>
      </div>

    </div>

    <div class="row">
    <div class="col-lg-12">
      <div class="portlet portlet-blue">
          <div class="portlet-heading">
              <div class="portlet-title">
                  <h4></h4>
              </div>
              <div class="clearfix"></div>
          </div>

          <div class="portlet-body">
                  <div class="table-responsive">

                    <table style="width:100%" border="0">
                      <tr>
                          <td>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>RUDE</th>
                                        <th>PATERNO</th>
                                        <th>MATERNO</th>
                                        <th>NOMBRE</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>{{studentTwo.codigo_rude}}</td>
                                        <td>{{studentTwo.paterno}}</td>
                                        <td>{{studentTwo.materno}}</td>
                                        <td>{{studentTwo.nombre}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <table class="table table-bordered">
                              <thead>
                                  <tr role="row">
                                    <th class="text-center">Gestion</th>
                                    <th class="text-center">SIE</th>
                                    <th class="text-center">Unidad Educativa</th>
                                    <th class="text-center">Nivel</th>
                                    <th class="text-center">Grado</th>
                                    <th class="text-center">Paralelo</th>
                                    <th class="text-center">Turno</th>
                                    <th class="text-center">Estado Matricula</th>
                                    <th class="text-center">Inscripcion</th>
                                    <th class="text-center">Opciones</th>
                                  </tr>
                              </thead>

                          <tbody role="alert" aria-live="polite" aria-relevant="all">

                                    <tr class = "success">
                                        <td data-title="Rude">{{studentTwo.gestion_tipo_id}}</td>
                                        <td data-title="Rude">{{studentTwo.institucioneducativa_titulo}}</td>
                                        <td data-title="Rude">{{studentTwo.institucioneducativa}}</td>
                                        <td data-title="Nombre">{{ studentTwo.nivel|e }} </td>
                                        <td data-title="Paterno">{{studentTwo.grado|e}}</td>
                                        <td data-title="Materno">{{studentTwo.paralelo|e}}</td>
                                        <td data-title="Turno">{{studentTwo.turno}} </td>
                                        <td data-title="Est. Matricula" class="text-center">{{studentTwo.em}}</td>
                                        <td data-title="Est. Matricula" class="text-center">{{studentTwo.emi}}</td>
                                        <td data-title="VerNota" class="text-center">
                                             <a href="#" onclick="seeNotaNew('{{studentTwo.eiid}}', '{{studentTwo.eid}}', '{{studentTwo.nivel_tipo_id}}', '{{studentTwo.grado_tipo_id}}', '{{studentTwo.pid}}', '{{studentTwo.turno_tipo_id}}', '{{studentTwo.gestion_tipo_id}}', '{{studentTwo.institucioneducativa_id}}')" ><span class="glyphicon glyphicon-eye-open"></span> Ver Calificaciones</a>
                                        </td>
                                    </tr>

                                </tbody>
                              </table>
                          </td>
                          <td>
                            <div id="studentTwoId" style="display:block">
                              <a href="#" onclick="deleteInscription('{{studentOne.eiid}}', '{{studentTwo.eiid}}', '{{studentTwo.eid}}', '{{studentTwo.gestion_tipo_id}}', '{{studentTwo.institucioneducativa_id}}', '{{studentTwo.estadomatricula_tipo_id}}', '{{idDetalle}}')" ><span class="glyphicon glyphicon-trash"></span> Eliminar Inscripción</a>
                            </div>
                          </td>
                      </tr>
                    </table>
                  </div>
              </div>
          </div>


      </div>

    </div>

    {% else %}
      {% for flashMessage in app.session.flashbag.get('successqak') %}
          <div class="alert alert-success" role="alert">
              <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <i class="glyphicon glyphicon-ok"></i> {{ flashMessage }}
          </div>
      {% endfor %}
  
    {% endif %}






    <div class="row">

      <div class="col-lg-12 text-left" style="margin-top:10px">
          <div id="responseId" class="alert" style="display:none;"></div>
      </div>
    </div>


    <div class="modal modal-flex fade" id="myModalNotas" tabindex="-1" role="dialog" aria-labelledby="flexModalLabel" aria-hidden="true">
        <div class="modal-dialog higherWider">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="flexModalLabel">Calificaciones</h4>

                </div>
                <div class="modal-body">
                    <div id="idNotas"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>

                </div>
            </div>

        </div>
    </div>
    <!-- end DASHBOARD CIRCLE TILES -->
{% endblock %}
{% block javascripts %}
    {{parent()}}
    <script>
        var seeNotaNew = function (inscripcionid, idstudent, nivel, grado, paralelo, turno, gestion, sie) {

            $('#myModalNotas').modal('show');
            $.ajax({
                type: 'get',
                url: Routing.generate('note_consultation_parents_sie_nota_new', {'inscripcionid': inscripcionid,'idstudent': idstudent, 'nivel': nivel, 'grado': grado, 'paralelo': paralelo, 'turno': turno, 'gestion': gestion, 'sie': sie}),
                beforeSend: function () {
                    $("#idNotas").empty();
                    $("#idNotas").append('<div class="text-center"><img src="{{asset('img/loading.gif')}}" class="loading img-responsive" /></div>');
                },
                success: function (data) {
                    $("#idNotas").empty();
                    $("#idNotas").append(data);
                },
                statusCode: {
                    500: function () {

                    },
                    404: function () {

                    }
                }
            });
        }

        var deleteInscription = function (inscripcionidValido, inscripcionidInValido,idstudent, gestion, sie, matriculaTipo, idDetalle) {
            // alert(matriculaTipo);return false;
            // $('#myModalNotas').modal('show');
            if(confirm('¿Está seguro de realizar los cambios?, tenga en cuenta que esta ratificando la inscripción del estudiante. ¿Desea continuar?')){

              $.ajax({
                  type: 'get',
                  url: Routing.generate('deleteInscriptionQa_deleteInscription', {'inscripcionidValido': inscripcionidValido,'inscripcionidInValido': inscripcionidInValido,'idstudent': idstudent,'gestion': gestion, 'sie': sie, 'matriculaTipo':matriculaTipo, 'idDetalle':idDetalle}),
                  beforeSend: function () {
                      $("#responseId").empty();
                      $("#responseId").css('display','block');
                      $("#responseId").append('<div class="text-center"><img src="{{asset('img/loading.gif')}}" class="loading img-responsive" /></div>');
                  },
                  success: function (data) {
                    $("#studentOneId").css('display','none');
                    $("#studentTwoId").css('display','none');

                    $("#responseId").empty();
                    $("#responseId").addClass('alert-'+data.typeMessage)
                    $("#responseId").append('<p>'+data.mensaje+'</p>');

                    

                  },
                  statusCode: {
                      500: function () {

                      },
                      404: function () {

                      }
                  }
              });
          }
        }
    </script>
{% endblock %}
